"use strict";(()=>{var pi=Object.create;var ct=Object.defineProperty;var yi=Object.getOwnPropertyDescriptor;var mi=Object.getOwnPropertyNames;var _i=Object.getPrototypeOf,gi=Object.prototype.hasOwnProperty;var d=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),bi=(r,t)=>{for(var e in t)ct(r,e,{get:t[e],enumerable:!0})},vi=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of mi(t))!gi.call(r,i)&&i!==e&&ct(r,i,{get:()=>t[i],enumerable:!(n=yi(t,i))||n.enumerable});return r};var lt=(r,t,e)=>(e=r!=null?pi(_i(r)):{},vi(t||!r||!r.__esModule?ct(e,"default",{value:r,enumerable:!0}):e,r));var ht=d((Rs,ft)=>{"use strict";var ce=typeof Reflect=="object"?Reflect:null,hn=ce&&typeof ce.apply=="function"?ce.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)},De;ce&&typeof ce.ownKeys=="function"?De=ce.ownKeys:Object.getOwnPropertySymbols?De=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:De=function(t){return Object.getOwnPropertyNames(t)};function wi(r){console&&console.warn&&console.warn(r)}var pn=Number.isNaN||function(t){return t!==t};function S(){S.init.call(this)}ft.exports=S;ft.exports.once=Ei;S.EventEmitter=S;S.prototype._events=void 0;S.prototype._eventsCount=0;S.prototype._maxListeners=void 0;var dn=10;function Ne(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(S,"defaultMaxListeners",{enumerable:!0,get:function(){return dn},set:function(r){if(typeof r!="number"||r<0||pn(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");dn=r}});S.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};S.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||pn(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function yn(r){return r._maxListeners===void 0?S.defaultMaxListeners:r._maxListeners}S.prototype.getMaxListeners=function(){return yn(this)};S.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=s[t];if(u===void 0)return!1;if(typeof u=="function")hn(u,this,e);else for(var c=u.length,l=vn(u,c),n=0;n<c;++n)hn(l[n],this,e);return!0};function mn(r,t,e,n){var i,s,o;if(Ne(e),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",t,e.listener?e.listener:e),s=r._events),o=s[t]),o===void 0)o=s[t]=e,++r._eventsCount;else if(typeof o=="function"?o=s[t]=n?[e,o]:[o,e]:n?o.unshift(e):o.push(e),i=yn(r),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=t,a.count=o.length,wi(a)}return r}S.prototype.addListener=function(t,e){return mn(this,t,e,!1)};S.prototype.on=S.prototype.addListener;S.prototype.prependListener=function(t,e){return mn(this,t,e,!0)};function Si(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _n(r,t,e){var n={fired:!1,wrapFn:void 0,target:r,type:t,listener:e},i=Si.bind(n);return i.listener=e,n.wrapFn=i,i}S.prototype.once=function(t,e){return Ne(e),this.on(t,_n(this,t,e)),this};S.prototype.prependOnceListener=function(t,e){return Ne(e),this.prependListener(t,_n(this,t,e)),this};S.prototype.removeListener=function(t,e){var n,i,s,o,a;if(Ne(e),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===e||n.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():xi(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,a||e)}return this};S.prototype.off=S.prototype.removeListener;S.prototype.removeAllListeners=function(t){var e,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=n[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function gn(r,t,e){var n=r._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?e?[i.listener||i]:[i]:e?Oi(i):vn(i,i.length)}S.prototype.listeners=function(t){return gn(this,t,!0)};S.prototype.rawListeners=function(t){return gn(this,t,!1)};S.listenerCount=function(r,t){return typeof r.listenerCount=="function"?r.listenerCount(t):bn.call(r,t)};S.prototype.listenerCount=bn;function bn(r){var t=this._events;if(t!==void 0){var e=t[r];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}S.prototype.eventNames=function(){return this._eventsCount>0?De(this._events):[]};function vn(r,t){for(var e=new Array(t),n=0;n<t;++n)e[n]=r[n];return e}function xi(r,t){for(;t+1<r.length;t++)r[t]=r[t+1];r.pop()}function Oi(r){for(var t=new Array(r.length),e=0;e<t.length;++e)t[e]=r[e].listener||r[e];return t}function Ei(r,t){return new Promise(function(e,n){function i(o){r.removeListener(t,s),n(o)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",i),e([].slice.call(arguments))}wn(r,t,s,{once:!0}),t!=="error"&&Ti(r,i,{once:!0})})}function Ti(r,t,e){typeof r.on=="function"&&wn(r,"error",t,e)}function wn(r,t,e,n){if(typeof r.on=="function")n.once?r.once(t,e):r.on(t,e);else if(typeof r.addEventListener=="function")r.addEventListener(t,function i(s){n.once&&r.removeEventListener(t,i),e(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var mt=d((Ro,kn)=>{"use strict";kn.exports=Ni;function Ni(r,t){for(var e=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)e[n++]=arguments[i++];return new Promise(function(a,u){e[n]=function(l){if(s)if(s=!1,l)u(l);else{for(var b=new Array(arguments.length-1),x=0;x<b.length;)b[x++]=arguments[x];a.apply(null,b)}};try{r.apply(t||null,e)}catch(c){s&&(s=!1,u(c))}})}});var An=d(Pn=>{"use strict";var ze=Pn;ze.length=function(t){var e=t.length;if(!e)return 0;for(var n=0;--e%4>1&&t.charAt(e)==="=";)++n;return Math.ceil(t.length*3)/4-n};var he=new Array(64),Cn=new Array(123);for(F=0;F<64;)Cn[he[F]=F<26?F+65:F<52?F+71:F<62?F-4:F-59|43]=F++;var F;ze.encode=function(t,e,n){for(var i=null,s=[],o=0,a=0,u;e<n;){var c=t[e++];switch(a){case 0:s[o++]=he[c>>2],u=(c&3)<<4,a=1;break;case 1:s[o++]=he[u|c>>4],u=(c&15)<<2,a=2;break;case 2:s[o++]=he[u|c>>6],s[o++]=he[c&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=he[u],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Rn="invalid encoding";ze.decode=function(t,e,n){for(var i=n,s=0,o,a=0;a<t.length;){var u=t.charCodeAt(a++);if(u===61&&s>1)break;if((u=Cn[u])===void 0)throw Error(Rn);switch(s){case 0:o=u,s=1;break;case 1:e[n++]=o<<2|(u&48)>>4,o=u,s=2;break;case 2:e[n++]=(o&15)<<4|(u&60)>>2,o=u,s=3;break;case 3:e[n++]=(o&3)<<6|u,s=0;break}}if(s===1)throw Error(Rn);return n-i};ze.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var Dn=d((Po,qn)=>{"use strict";qn.exports=We;function We(){this._listeners={}}We.prototype.on=function(t,e,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:n||this}),this};We.prototype.off=function(t,e){if(t===void 0)this._listeners={};else if(e===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===e?n.splice(i,1):++i;return this};We.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<e.length;)e[i].fn.apply(e[i++].ctx,n)}return this}});var Jn=d((Ao,Fn)=>{"use strict";Fn.exports=Nn(Nn);function Nn(r){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),e=new Uint8Array(t.buffer),n=e[3]===128;function i(u,c,l){t[0]=u,c[l]=e[0],c[l+1]=e[1],c[l+2]=e[2],c[l+3]=e[3]}function s(u,c,l){t[0]=u,c[l]=e[3],c[l+1]=e[2],c[l+2]=e[1],c[l+3]=e[0]}r.writeFloatLE=n?i:s,r.writeFloatBE=n?s:i;function o(u,c){return e[0]=u[c],e[1]=u[c+1],e[2]=u[c+2],e[3]=u[c+3],t[0]}function a(u,c){return e[3]=u[c],e[2]=u[c+1],e[1]=u[c+2],e[0]=u[c+3],t[0]}r.readFloatLE=n?o:a,r.readFloatBE=n?a:o}():function(){function t(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var u=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-u)*8388608)&8388607;n((a<<31|u+127<<23|c)>>>0,s,o)}}r.writeFloatLE=t.bind(null,Ln),r.writeFloatBE=t.bind(null,In);function e(n,i,s){var o=n(i,s),a=(o>>31)*2+1,u=o>>>23&255,c=o&8388607;return u===255?c?NaN:a*(1/0):u===0?a*1401298464324817e-60*c:a*Math.pow(2,u-150)*(c+8388608)}r.readFloatLE=e.bind(null,Bn),r.readFloatBE=e.bind(null,jn)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),e=new Uint8Array(t.buffer),n=e[7]===128;function i(u,c,l){t[0]=u,c[l]=e[0],c[l+1]=e[1],c[l+2]=e[2],c[l+3]=e[3],c[l+4]=e[4],c[l+5]=e[5],c[l+6]=e[6],c[l+7]=e[7]}function s(u,c,l){t[0]=u,c[l]=e[7],c[l+1]=e[6],c[l+2]=e[5],c[l+3]=e[4],c[l+4]=e[3],c[l+5]=e[2],c[l+6]=e[1],c[l+7]=e[0]}r.writeDoubleLE=n?i:s,r.writeDoubleBE=n?s:i;function o(u,c){return e[0]=u[c],e[1]=u[c+1],e[2]=u[c+2],e[3]=u[c+3],e[4]=u[c+4],e[5]=u[c+5],e[6]=u[c+6],e[7]=u[c+7],t[0]}function a(u,c){return e[7]=u[c],e[6]=u[c+1],e[5]=u[c+2],e[4]=u[c+3],e[3]=u[c+4],e[2]=u[c+5],e[1]=u[c+6],e[0]=u[c+7],t[0]}r.readDoubleLE=n?o:a,r.readDoubleBE=n?a:o}():function(){function t(n,i,s,o,a,u){var c=o<0?1:0;if(c&&(o=-o),o===0)n(0,a,u+i),n(1/o>0?0:2147483648,a,u+s);else if(isNaN(o))n(0,a,u+i),n(2146959360,a,u+s);else if(o>17976931348623157e292)n(0,a,u+i),n((c<<31|2146435072)>>>0,a,u+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,n(l>>>0,a,u+i),n((c<<31|l/4294967296)>>>0,a,u+s);else{var b=Math.floor(Math.log(o)/Math.LN2);b===1024&&(b=1023),l=o*Math.pow(2,-b),n(l*4503599627370496>>>0,a,u+i),n((c<<31|b+1023<<20|l*1048576&1048575)>>>0,a,u+s)}}}r.writeDoubleLE=t.bind(null,Ln,0,4),r.writeDoubleBE=t.bind(null,In,4,0);function e(n,i,s,o,a){var u=n(o,a+i),c=n(o,a+s),l=(c>>31)*2+1,b=c>>>20&2047,x=4294967296*(c&1048575)+u;return b===2047?x?NaN:l*(1/0):b===0?l*5e-324*x:l*Math.pow(2,b-1075)*(x+4503599627370496)}r.readDoubleLE=e.bind(null,Bn,0,4),r.readDoubleBE=e.bind(null,jn,4,0)}(),r}function Ln(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}function In(r,t,e){t[e]=r>>>24,t[e+1]=r>>>16&255,t[e+2]=r>>>8&255,t[e+3]=r&255}function Bn(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16|r[t+3]<<24)>>>0}function jn(r,t){return(r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3])>>>0}});var _t=d((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var Un=d(Mn=>{"use strict";var gt=Mn;gt.length=function(t){for(var e=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?e+=1:n<2048?e+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,e+=4):e+=3;return e};gt.read=function(t,e,n){var i=n-e;if(i<1)return"";for(var s=null,o=[],a=0,u;e<n;)u=t[e++],u<128?o[a++]=u:u>191&&u<224?o[a++]=(u&31)<<6|t[e++]&63:u>239&&u<365?(u=((u&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,o[a++]=55296+(u>>10),o[a++]=56320+(u&1023)):o[a++]=(u&15)<<12|(t[e++]&63)<<6|t[e++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};gt.write=function(t,e,n){for(var i=n,s,o,a=0;a<t.length;++a)s=t.charCodeAt(a),s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&((o=t.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128);return n-i}});var Wn=d((Do,zn)=>{"use strict";zn.exports=Li;function Li(r,t,e){var n=e||8192,i=n>>>1,s=null,o=n;return function(u){if(u<1||u>i)return r(u);o+u>n&&(s=r(n),o=0);var c=t.call(s,o,o+=u);return o&7&&(o=(o|7)+1),c}}});var Hn=d((No,$n)=>{"use strict";$n.exports=R;var we=W();function R(r,t){this.lo=r>>>0,this.hi=t>>>0}var ie=R.zero=new R(0,0);ie.toNumber=function(){return 0};ie.zzEncode=ie.zzDecode=function(){return this};ie.length=function(){return 1};var Ii=R.zeroHash="\0\0\0\0\0\0\0\0";R.fromNumber=function(t){if(t===0)return ie;var e=t<0;e&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return e&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new R(n,i)};R.from=function(t){if(typeof t=="number")return R.fromNumber(t);if(we.isString(t))if(we.Long)t=we.Long.fromString(t);else return R.fromNumber(parseInt(t,10));return t.low||t.high?new R(t.low>>>0,t.high>>>0):ie};R.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=~this.lo+1>>>0,n=~this.hi>>>0;return e||(n=n+1>>>0),-(e+n*4294967296)}return this.lo+this.hi*4294967296};R.prototype.toLong=function(t){return we.Long?new we.Long(this.lo|0,this.hi|0,!!t):{low:this.lo|0,high:this.hi|0,unsigned:!!t}};var Q=String.prototype.charCodeAt;R.fromHash=function(t){return t===Ii?ie:new R((Q.call(t,0)|Q.call(t,1)<<8|Q.call(t,2)<<16|Q.call(t,3)<<24)>>>0,(Q.call(t,4)|Q.call(t,5)<<8|Q.call(t,6)<<16|Q.call(t,7)<<24)>>>0)};R.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};R.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};R.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};R.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?e===0?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}});var W=d(bt=>{"use strict";var f=bt;f.asPromise=mt();f.base64=An();f.EventEmitter=Dn();f.float=Jn();f.inquire=_t();f.utf8=Un();f.pool=Wn();f.LongBits=Hn();f.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);f.global=f.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||bt;f.emptyArray=Object.freeze?Object.freeze([]):[];f.emptyObject=Object.freeze?Object.freeze({}):{};f.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};f.isString=function(t){return typeof t=="string"||t instanceof String};f.isObject=function(t){return t&&typeof t=="object"};f.isset=f.isSet=function(t,e){var n=t[e];return n!=null&&t.hasOwnProperty(e)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};f.Buffer=function(){try{var r=f.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}();f._Buffer_from=null;f._Buffer_allocUnsafe=null;f.newBuffer=function(t){return typeof t=="number"?f.Buffer?f._Buffer_allocUnsafe(t):new f.Array(t):f.Buffer?f._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};f.Array=typeof Uint8Array<"u"?Uint8Array:Array;f.Long=f.global.dcodeIO&&f.global.dcodeIO.Long||f.global.Long||f.inquire("long");f.key2Re=/^true|false|0|1$/;f.key32Re=/^-?(?:0|[1-9][0-9]*)$/;f.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;f.longToHash=function(t){return t?f.LongBits.from(t).toHash():f.LongBits.zeroHash};f.longFromHash=function(t,e){var n=f.LongBits.fromHash(t);return f.Long?f.Long.fromBits(n.lo,n.hi,e):n.toNumber(!!e)};function Vn(r,t,e){for(var n=Object.keys(t),i=0;i<n.length;++i)(r[n[i]]===void 0||!e)&&(r[n[i]]=t[n[i]]);return r}f.merge=Vn;f.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Kn(r){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Vn(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}f.newError=Kn;f.ProtocolError=Kn("ProtocolError");f.oneOfGetter=function(t){for(var e={},n=0;n<t.length;++n)e[t[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(e[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};f.oneOfSetter=function(t){return function(e){for(var n=0;n<t.length;++n)t[n]!==e&&delete this[t[n]]}};f.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};f._configure=function(){var r=f.Buffer;if(!r){f._Buffer_from=f._Buffer_allocUnsafe=null;return}f._Buffer_from=r.from!==Uint8Array.from&&r.from||function(e,n){return new r(e,n)},f._Buffer_allocUnsafe=r.allocUnsafe||function(e){return new r(e)}}});var He=d((Io,Qn)=>{"use strict";Qn.exports=_;var N=W(),vt,$e=N.LongBits,Zn=N.base64,Gn=N.utf8;function Se(r,t,e){this.fn=r,this.len=t,this.next=void 0,this.val=e}function St(){}function Bi(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function _(){this.len=0,this.head=new Se(St,0,0),this.tail=this.head,this.states=null}var Xn=function(){return N.Buffer?function(){return(_.create=function(){return new vt})()}:function(){return new _}};_.create=Xn();_.alloc=function(t){return new N.Array(t)};N.Array!==Array&&(_.alloc=N.pool(_.alloc,N.Array.prototype.subarray));_.prototype._push=function(t,e,n){return this.tail=this.tail.next=new Se(t,e,n),this.len+=e,this};function xt(r,t,e){t[e]=r&255}function ji(r,t,e){for(;r>127;)t[e++]=r&127|128,r>>>=7;t[e]=r}function Ot(r,t){this.len=r,this.next=void 0,this.val=t}Ot.prototype=Object.create(Se.prototype);Ot.prototype.fn=ji;_.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new Ot((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};_.prototype.int32=function(t){return t<0?this._push(Et,10,$e.fromNumber(t)):this.uint32(t)};_.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Et(r,t,e){for(;r.hi;)t[e++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)t[e++]=r.lo&127|128,r.lo=r.lo>>>7;t[e++]=r.lo}_.prototype.uint64=function(t){var e=$e.from(t);return this._push(Et,e.length(),e)};_.prototype.int64=_.prototype.uint64;_.prototype.sint64=function(t){var e=$e.from(t).zzEncode();return this._push(Et,e.length(),e)};_.prototype.bool=function(t){return this._push(xt,1,t?1:0)};function wt(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}_.prototype.fixed32=function(t){return this._push(wt,4,t>>>0)};_.prototype.sfixed32=_.prototype.fixed32;_.prototype.fixed64=function(t){var e=$e.from(t);return this._push(wt,4,e.lo)._push(wt,4,e.hi)};_.prototype.sfixed64=_.prototype.fixed64;_.prototype.float=function(t){return this._push(N.float.writeFloatLE,4,t)};_.prototype.double=function(t){return this._push(N.float.writeDoubleLE,8,t)};var Fi=N.Array.prototype.set?function(t,e,n){e.set(t,n)}:function(t,e,n){for(var i=0;i<t.length;++i)e[n+i]=t[i]};_.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(xt,1,0);if(N.isString(t)){var n=_.alloc(e=Zn.length(t));Zn.decode(t,n,0),t=n}return this.uint32(e)._push(Fi,e,t)};_.prototype.string=function(t){var e=Gn.length(t);return e?this.uint32(e)._push(Gn.write,e,t):this._push(xt,1,0)};_.prototype.fork=function(){return this.states=new Bi(this),this.head=this.tail=new Se(St,0,0),this.len=0,this};_.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Se(St,0,0),this.len=0),this};_.prototype.ldelim=function(){var t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this};_.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e};_._configure=function(r){vt=r,_.create=Xn(),vt._configure()}});var tr=d((Bo,er)=>{"use strict";er.exports=$;var Yn=He();($.prototype=Object.create(Yn.prototype)).constructor=$;var Y=W();function $(){Yn.call(this)}$._configure=function(){$.alloc=Y._Buffer_allocUnsafe,$.writeBytesBuffer=Y.Buffer&&Y.Buffer.prototype instanceof Uint8Array&&Y.Buffer.prototype.set.name==="set"?function(t,e,n){e.set(t,n)}:function(t,e,n){if(t.copy)t.copy(e,n,0,t.length);else for(var i=0;i<t.length;)e[n++]=t[i++]}};$.prototype.bytes=function(t){Y.isString(t)&&(t=Y._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push($.writeBytesBuffer,e,t),this};function Ji(r,t,e){r.length<40?Y.utf8.write(r,t,e):t.utf8Write?t.utf8Write(r,e):t.write(r,e)}$.prototype.string=function(t){var e=Y.Buffer.byteLength(t);return this.uint32(e),e&&this._push(Ji,e,t),this};$._configure()});var Ke=d((jo,or)=>{"use strict";or.exports=E;var J=W(),kt,ir=J.LongBits,Mi=J.utf8;function M(r,t){return RangeError("index out of range: "+r.pos+" + "+(t||1)+" > "+r.len)}function E(r){this.buf=r,this.pos=0,this.len=r.length}var nr=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new E(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new E(t);throw Error("illegal buffer")},sr=function(){return J.Buffer?function(e){return(E.create=function(i){return J.Buffer.isBuffer(i)?new kt(i):nr(i)})(e)}:nr};E.create=sr();E.prototype._slice=J.Array.prototype.subarray||J.Array.prototype.slice;E.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,M(this,10);return t}}();E.prototype.int32=function(){return this.uint32()|0};E.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function Tt(){var r=new ir(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw M(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,r}if(this.len-this.pos>4){for(;t<5;++t)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;t<5;++t){if(this.pos>=this.len)throw M(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}E.prototype.bool=function(){return this.uint32()!==0};function Ve(r,t){return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0}E.prototype.fixed32=function(){if(this.pos+4>this.len)throw M(this,4);return Ve(this.buf,this.pos+=4)};E.prototype.sfixed32=function(){if(this.pos+4>this.len)throw M(this,4);return Ve(this.buf,this.pos+=4)|0};function rr(){if(this.pos+8>this.len)throw M(this,8);return new ir(Ve(this.buf,this.pos+=4),Ve(this.buf,this.pos+=4))}E.prototype.float=function(){if(this.pos+4>this.len)throw M(this,4);var t=J.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};E.prototype.double=function(){if(this.pos+8>this.len)throw M(this,4);var t=J.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};E.prototype.bytes=function(){var t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw M(this,t);if(this.pos+=t,Array.isArray(this.buf))return this.buf.slice(e,n);if(e===n){var i=J.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,e,n)};E.prototype.string=function(){var t=this.bytes();return Mi.read(t,0,t.length)};E.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw M(this,t);this.pos+=t}else do if(this.pos>=this.len)throw M(this);while(this.buf[this.pos++]&128);return this};E.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};E._configure=function(r){kt=r,E.create=sr(),kt._configure();var t=J.Long?"toLong":"toNumber";J.merge(E.prototype,{int64:function(){return Tt.call(this)[t](!1)},uint64:function(){return Tt.call(this)[t](!0)},sint64:function(){return Tt.call(this).zzDecode()[t](!1)},fixed64:function(){return rr.call(this)[t](!0)},sfixed64:function(){return rr.call(this)[t](!1)}})}});var lr=d((Fo,cr)=>{"use strict";cr.exports=se;var ur=Ke();(se.prototype=Object.create(ur.prototype)).constructor=se;var ar=W();function se(r){ur.call(this,r)}se._configure=function(){ar.Buffer&&(se.prototype._slice=ar.Buffer.prototype.slice)};se.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};se._configure()});var hr=d((Jo,fr)=>{"use strict";fr.exports=xe;var Rt=W();(xe.prototype=Object.create(Rt.EventEmitter.prototype)).constructor=xe;function xe(r,t,e){if(typeof r!="function")throw TypeError("rpcImpl must be a function");Rt.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=!!t,this.responseDelimited=!!e}xe.prototype.rpcCall=function r(t,e,n,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return Rt.asPromise(r,o,t,e,n,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(t,e[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(u,c){if(u)return o.emit("error",u,t),s(u);if(c===null){o.end(!0);return}if(!(c instanceof n))try{c=n[o.responseDelimited?"decodeDelimited":"decode"](c)}catch(l){return o.emit("error",l,t),s(l)}return o.emit("data",c,t),s(null,c)})}catch(a){o.emit("error",a,t),setTimeout(function(){s(a)},0);return}};xe.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Ct=d(dr=>{"use strict";var Ui=dr;Ui.Service=hr()});var Pt=d((Uo,pr)=>{"use strict";pr.exports={}});var _r=d(mr=>{"use strict";var A=mr;A.build="minimal";A.Writer=He();A.BufferWriter=tr();A.Reader=Ke();A.BufferReader=lr();A.util=W();A.rpc=Ct();A.roots=Pt();A.configure=yr;function yr(){A.util._configure(),A.Writer._configure(A.BufferWriter),A.Reader._configure(A.BufferReader)}yr()});var br=d((Wo,gr)=>{"use strict";gr.exports=At;function At(r,t){typeof r=="string"&&(t=r,r=void 0);var e=[];function n(s){if(typeof s!="string"){var o=i();if(At.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),u=new Array(a.length+1),c=new Array(a.length),l=0;l<a.length;)u[l]=a[l],c[l]=s[a[l++]];return u[l]=o,Function.apply(null,u).apply(null,c)}return Function(o)()}for(var b=new Array(arguments.length-1),x=0;x<b.length;)b[x]=arguments[++x];if(x=0,s=s.replace(/%([%dfijs])/g,function(h,y){var v=b[x++];switch(y){case"d":case"f":return String(Number(v));case"i":return String(Math.floor(v));case"j":return JSON.stringify(v);case"s":return String(v)}return"%"}),x!==b.length)throw Error("parameter count mismatch");return e.push(s),n}function i(s){return"function "+(s||t||"")+"("+(r&&r.join(",")||"")+`){
  `+e.join(`
  `)+`
}`}return n.toString=i,n}At.verbose=!1});var wr=d(($o,vr)=>{"use strict";vr.exports=Oe;var zi=mt(),Wi=_t(),qt=Wi("fs");function Oe(r,t,e){return typeof t=="function"?(e=t,t={}):t||(t={}),e?!t.xhr&&qt&&qt.readFile?qt.readFile(r,function(i,s){return i&&typeof XMLHttpRequest<"u"?Oe.xhr(r,t,e):i?e(i):e(null,t.binary?s:s.toString("utf8"))}):Oe.xhr(r,t,e):zi(Oe,this,r,t)}Oe.xhr=function(t,e,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return n(Error("status "+i.status));if(e.binary){var o=i.response;if(!o){o=[];for(var a=0;a<i.responseText.length;++a)o.push(i.responseText.charCodeAt(a)&255)}return n(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return n(null,i.responseText)}},e.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",t),i.send()}});var Or=d(xr=>{"use strict";var Nt=xr,Sr=Nt.isAbsolute=function(t){return/^(?:\/|\w+:)/.test(t)},Dt=Nt.normalize=function(t){t=t.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var e=t.split("/"),n=Sr(t),i="";n&&(i=e.shift()+"/");for(var s=0;s<e.length;)e[s]===".."?s>0&&e[s-1]!==".."?e.splice(--s,2):n?e.splice(s,1):++s:e[s]==="."?e.splice(s,1):++s;return i+e.join("/")};Nt.resolve=function(t,e,n){return n||(e=Dt(e)),Sr(e)?e:(n||(t=Dt(t)),(t=t.replace(/(?:\/|^)[^/]+$/,"")).length?Dt(t+"/"+e):e)}});var de=d(Er=>{"use strict";var Ee=Er,$i=C(),Hi=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Te(r,t){var e=0,n={};for(t|=0;e<r.length;)n[Hi[e+t]]=r[e++];return n}Ee.basic=Te([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Ee.defaults=Te([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",$i.emptyArray,null]);Ee.long=Te([0,0,0,1,1],7);Ee.mapKey=Te([0,0,0,5,5,0,0,0,1,1,0,2],2);Ee.packed=Te([1,5,0,0,0,5,5,0,0,0,1,1,0])});var oe=d((Ko,Rr)=>{"use strict";Rr.exports=L;var Ze=ae();((L.prototype=Object.create(Ze.prototype)).constructor=L).className="Field";var Tr=H(),kr=de(),k=C(),Lt,Vi=/^required|optional|repeated$/;L.fromJSON=function(t,e){return new L(t,e.id,e.type,e.rule,e.extend,e.options,e.comment)};function L(r,t,e,n,i,s,o){if(k.isObject(n)?(o=i,s=n,n=i=void 0):k.isObject(i)&&(o=s,s=i,i=void 0),Ze.call(this,r,s),!k.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!k.isString(e))throw TypeError("type must be a string");if(n!==void 0&&!Vi.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!k.isString(i))throw TypeError("extend must be a string");n==="proto3_optional"&&(n="optional"),this.rule=n&&n!=="optional"?n:void 0,this.type=e,this.id=t,this.extend=i||void 0,this.required=n==="required",this.optional=!this.required,this.repeated=n==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=k.Long?kr.long[e]!==void 0:!1,this.bytes=e==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(L.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});L.prototype.setOption=function(t,e,n){return t==="packed"&&(this._packed=null),Ze.prototype.setOption.call(this,t,e,n)};L.prototype.toJSON=function(t){var e=t?!!t.keepComments:!1;return k.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",e?this.comment:void 0])};L.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=kr.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof Lt?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof Tr&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof Tr))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=k.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var t;k.base64.test(this.typeDefault)?k.base64.decode(this.typeDefault,t=k.newBuffer(k.base64.length(this.typeDefault)),0):k.utf8.write(this.typeDefault,t=k.newBuffer(k.utf8.length(this.typeDefault)),0),this.typeDefault=t}return this.map?this.defaultValue=k.emptyObject:this.repeated?this.defaultValue=k.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof Lt&&(this.parent.ctor.prototype[this.name]=this.defaultValue),Ze.prototype.resolve.call(this)};L.d=function(t,e,n,i){return typeof e=="function"?e=k.decorateType(e).name:e&&typeof e=="object"&&(e=k.decorateEnum(e).name),function(o,a){k.decorateType(o.constructor).add(new L(a,t,e,n,{default:i}))}};L._configure=function(t){Lt=t}});var ke=d((Zo,Ar)=>{"use strict";Ar.exports=I;var Xe=ae();((I.prototype=Object.create(Xe.prototype)).constructor=I).className="OneOf";var Cr=oe(),Ge=C();function I(r,t,e,n){if(Array.isArray(t)||(e=t,t=void 0),Xe.call(this,r,e),!(t===void 0||Array.isArray(t)))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=n}I.fromJSON=function(t,e){return new I(t,e.oneof,e.options,e.comment)};I.prototype.toJSON=function(t){var e=t?!!t.keepComments:!1;return Ge.toObject(["options",this.options,"oneof",this.oneof,"comment",e?this.comment:void 0])};function Pr(r){if(r.parent)for(var t=0;t<r.fieldsArray.length;++t)r.fieldsArray[t].parent||r.parent.add(r.fieldsArray[t])}I.prototype.add=function(t){if(!(t instanceof Cr))throw TypeError("field must be a Field");return t.parent&&t.parent!==this.parent&&t.parent.remove(t),this.oneof.push(t.name),this.fieldsArray.push(t),t.partOf=this,Pr(this),this};I.prototype.remove=function(t){if(!(t instanceof Cr))throw TypeError("field must be a Field");var e=this.fieldsArray.indexOf(t);if(e<0)throw Error(t+" is not a member of "+this);return this.fieldsArray.splice(e,1),e=this.oneof.indexOf(t.name),e>-1&&this.oneof.splice(e,1),t.partOf=null,this};I.prototype.onAdd=function(t){Xe.prototype.onAdd.call(this,t);for(var e=this,n=0;n<this.oneof.length;++n){var i=t.get(this.oneof[n]);i&&!i.partOf&&(i.partOf=e,e.fieldsArray.push(i))}Pr(this)};I.prototype.onRemove=function(t){for(var e=0,n;e<this.fieldsArray.length;++e)(n=this.fieldsArray[e]).parent&&n.parent.remove(n);Xe.prototype.onRemove.call(this,t)};I.d=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;)t[e]=arguments[e++];return function(i,s){Ge.decorateType(i.constructor).add(new I(s,t)),Object.defineProperty(i,s,{get:Ge.oneOfGetter(t),set:Ge.oneOfSetter(t)})}}});var me=d((Go,Lr)=>{"use strict";Lr.exports=g;var It=ae();((g.prototype=Object.create(It.prototype)).constructor=g).className="Namespace";var qr=oe(),Qe=C(),Ki=ke(),pe,Re,ye;g.fromJSON=function(t,e){return new g(t,e.options).addJSON(e.nested)};function Dr(r,t){if(r&&r.length){for(var e={},n=0;n<r.length;++n)e[r[n].name]=r[n].toJSON(t);return e}}g.arrayToJSON=Dr;g.isReservedId=function(t,e){if(t){for(var n=0;n<t.length;++n)if(typeof t[n]!="string"&&t[n][0]<=e&&t[n][1]>e)return!0}return!1};g.isReservedName=function(t,e){if(t){for(var n=0;n<t.length;++n)if(t[n]===e)return!0}return!1};function g(r,t){It.call(this,r,t),this.nested=void 0,this._nestedArray=null}function Nr(r){return r._nestedArray=null,r}Object.defineProperty(g.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=Qe.toArray(this.nested))}});g.prototype.toJSON=function(t){return Qe.toObject(["options",this.options,"nested",Dr(this.nestedArray,t)])};g.prototype.addJSON=function(t){var e=this;if(t)for(var n=Object.keys(t),i=0,s;i<n.length;++i)s=t[n[i]],e.add((s.fields!==void 0?pe.fromJSON:s.values!==void 0?ye.fromJSON:s.methods!==void 0?Re.fromJSON:s.id!==void 0?qr.fromJSON:g.fromJSON)(n[i],s));return this};g.prototype.get=function(t){return this.nested&&this.nested[t]||null};g.prototype.getEnum=function(t){if(this.nested&&this.nested[t]instanceof ye)return this.nested[t].values;throw Error("no such enum: "+t)};g.prototype.add=function(t){if(!(t instanceof qr&&t.extend!==void 0||t instanceof pe||t instanceof Ki||t instanceof ye||t instanceof Re||t instanceof g))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var e=this.get(t.name);if(e)if(e instanceof g&&t instanceof g&&!(e instanceof pe||e instanceof Re)){for(var n=e.nestedArray,i=0;i<n.length;++i)t.add(n[i]);this.remove(e),this.nested||(this.nested={}),t.setOptions(e.options,!0)}else throw Error("duplicate name '"+t.name+"' in "+this)}return this.nested[t.name]=t,t.onAdd(this),Nr(this)};g.prototype.remove=function(t){if(!(t instanceof It))throw TypeError("object must be a ReflectionObject");if(t.parent!==this)throw Error(t+" is not a member of "+this);return delete this.nested[t.name],Object.keys(this.nested).length||(this.nested=void 0),t.onRemove(this),Nr(this)};g.prototype.define=function(t,e){if(Qe.isString(t))t=t.split(".");else if(!Array.isArray(t))throw TypeError("illegal path");if(t&&t.length&&t[0]==="")throw Error("path must be relative");for(var n=this;t.length>0;){var i=t.shift();if(n.nested&&n.nested[i]){if(n=n.nested[i],!(n instanceof g))throw Error("path conflicts with non-namespace objects")}else n.add(n=new g(i))}return e&&n.addJSON(e),n};g.prototype.resolveAll=function(){for(var t=this.nestedArray,e=0;e<t.length;)t[e]instanceof g?t[e++].resolveAll():t[e++].resolve();return this.resolve()};g.prototype.lookup=function(t,e,n){if(typeof e=="boolean"?(n=e,e=void 0):e&&!Array.isArray(e)&&(e=[e]),Qe.isString(t)&&t.length){if(t===".")return this.root;t=t.split(".")}else if(!t.length)return this;if(t[0]==="")return this.root.lookup(t.slice(1),e);var i=this.get(t[0]);if(i){if(t.length===1){if(!e||e.indexOf(i.constructor)>-1)return i}else if(i instanceof g&&(i=i.lookup(t.slice(1),e,!0)))return i}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof g&&(i=this._nestedArray[s].lookup(t,e,!0)))return i;return this.parent===null||n?null:this.parent.lookup(t,e)};g.prototype.lookupType=function(t){var e=this.lookup(t,[pe]);if(!e)throw Error("no such type: "+t);return e};g.prototype.lookupEnum=function(t){var e=this.lookup(t,[ye]);if(!e)throw Error("no such Enum '"+t+"' in "+this);return e};g.prototype.lookupTypeOrEnum=function(t){var e=this.lookup(t,[pe,ye]);if(!e)throw Error("no such Type or Enum '"+t+"' in "+this);return e};g.prototype.lookupService=function(t){var e=this.lookup(t,[Re]);if(!e)throw Error("no such Service '"+t+"' in "+this);return e};g._configure=function(r,t,e){pe=r,Re=t,ye=e}});var jt=d((Xo,Ir)=>{"use strict";Ir.exports=G;var Bt=oe();((G.prototype=Object.create(Bt.prototype)).constructor=G).className="MapField";var Zi=de(),Ce=C();function G(r,t,e,n,i,s){if(Bt.call(this,r,t,n,void 0,void 0,i,s),!Ce.isString(e))throw TypeError("keyType must be a string");this.keyType=e,this.resolvedKeyType=null,this.map=!0}G.fromJSON=function(t,e){return new G(t,e.id,e.keyType,e.type,e.options,e.comment)};G.prototype.toJSON=function(t){var e=t?!!t.keepComments:!1;return Ce.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",e?this.comment:void 0])};G.prototype.resolve=function(){if(this.resolved)return this;if(Zi.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return Bt.prototype.resolve.call(this)};G.d=function(t,e,n){return typeof n=="function"?n=Ce.decorateType(n).name:n&&typeof n=="object"&&(n=Ce.decorateEnum(n).name),function(s,o){Ce.decorateType(s.constructor).add(new G(o,t,e,n))}}});var Jt=d((Qo,Br)=>{"use strict";Br.exports=ue;var Ft=ae();((ue.prototype=Object.create(Ft.prototype)).constructor=ue).className="Method";var _e=C();function ue(r,t,e,n,i,s,o,a,u){if(_e.isObject(i)?(o=i,i=s=void 0):_e.isObject(s)&&(o=s,s=void 0),!(t===void 0||_e.isString(t)))throw TypeError("type must be a string");if(!_e.isString(e))throw TypeError("requestType must be a string");if(!_e.isString(n))throw TypeError("responseType must be a string");Ft.call(this,r,o),this.type=t||"rpc",this.requestType=e,this.requestStream=i?!0:void 0,this.responseType=n,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=u}ue.fromJSON=function(t,e){return new ue(t,e.type,e.requestType,e.responseType,e.requestStream,e.responseStream,e.options,e.comment,e.parsedOptions)};ue.prototype.toJSON=function(t){var e=t?!!t.keepComments:!1;return _e.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",e?this.comment:void 0,"parsedOptions",this.parsedOptions])};ue.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),Ft.prototype.resolve.call(this))}});var Ut=d((Yo,Fr)=>{"use strict";Fr.exports=B;var ee=me();((B.prototype=Object.create(ee.prototype)).constructor=B).className="Service";var Mt=Jt(),Pe=C(),Gi=Ct();function B(r,t){ee.call(this,r,t),this.methods={},this._methodsArray=null}B.fromJSON=function(t,e){var n=new B(t,e.options);if(e.methods)for(var i=Object.keys(e.methods),s=0;s<i.length;++s)n.add(Mt.fromJSON(i[s],e.methods[i[s]]));return e.nested&&n.addJSON(e.nested),n.comment=e.comment,n};B.prototype.toJSON=function(t){var e=ee.prototype.toJSON.call(this,t),n=t?!!t.keepComments:!1;return Pe.toObject(["options",e&&e.options||void 0,"methods",ee.arrayToJSON(this.methodsArray,t)||{},"nested",e&&e.nested||void 0,"comment",n?this.comment:void 0])};Object.defineProperty(B.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Pe.toArray(this.methods))}});function jr(r){return r._methodsArray=null,r}B.prototype.get=function(t){return this.methods[t]||ee.prototype.get.call(this,t)};B.prototype.resolveAll=function(){for(var t=this.methodsArray,e=0;e<t.length;++e)t[e].resolve();return ee.prototype.resolve.call(this)};B.prototype.add=function(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);return t instanceof Mt?(this.methods[t.name]=t,t.parent=this,jr(this)):ee.prototype.add.call(this,t)};B.prototype.remove=function(t){if(t instanceof Mt){if(this.methods[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.methods[t.name],t.parent=null,jr(this)}return ee.prototype.remove.call(this,t)};B.prototype.create=function(t,e,n){for(var i=new Gi.Service(t,e,n),s=0,o;s<this.methodsArray.length;++s){var a=Pe.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[a]=Pe.codegen(["r","c"],Pe.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return i}});var Ye=d((ea,Jr)=>{"use strict";Jr.exports=V;var Xi=W();function V(r){if(r)for(var t=Object.keys(r),e=0;e<t.length;++e)this[t[e]]=r[t[e]]}V.create=function(t){return this.$type.create(t)};V.encode=function(t,e){return this.$type.encode(t,e)};V.encodeDelimited=function(t,e){return this.$type.encodeDelimited(t,e)};V.decode=function(t){return this.$type.decode(t)};V.decodeDelimited=function(t){return this.$type.decodeDelimited(t)};V.verify=function(t){return this.$type.verify(t)};V.fromObject=function(t){return this.$type.fromObject(t)};V.toObject=function(t,e){return this.$type.toObject(t,e)};V.prototype.toJSON=function(){return this.$type.toObject(this,Xi.toJSONOptions)}});var zt=d((ta,Ur)=>{"use strict";Ur.exports=es;var Qi=H(),X=de(),Mr=C();function Yi(r){return"missing required '"+r.name+"'"}function es(r){var t=Mr.codegen(["r","l"],r.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(r.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");r.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var e=0;e<r.fieldsArray.length;++e){var n=r._fieldsArray[e].resolve(),i=n.resolvedType instanceof Qi?"int32":n.type,s="m"+Mr.safeProp(n.name);t("case %i: {",n.id),n.map?(t("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),X.defaults[n.keyType]!==void 0?t("k=%j",X.defaults[n.keyType]):t("k=null"),X.defaults[i]!==void 0?t("value=%j",X.defaults[i]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",n.keyType)("case 2:"),X.basic[i]===void 0?t("value=types[%i].decode(r,r.uint32())",e):t("value=r.%s()",i),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),X.long[n.keyType]!==void 0?t('%s[typeof k==="object"?util.longToHash(k):k]=value',s):t("%s[k]=value",s)):n.repeated?(t("if(!(%s&&%s.length))",s,s)("%s=[]",s),X.packed[i]!==void 0&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),X.basic[i]===void 0?t(n.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,e):t("%s.push(r.%s())",s,i)):X.basic[i]===void 0?t(n.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,e):t("%s=r.%s()",s,i),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),e=0;e<r._fieldsArray.length;++e){var o=r._fieldsArray[e];o.required&&t("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",Yi(o))}return t("return m")}});var Ht=d((na,zr)=>{"use strict";zr.exports=rs;var ts=H(),Wt=C();function j(r,t){return r.name+": "+t+(r.repeated&&t!=="array"?"[]":r.map&&t!=="object"?"{k:"+r.keyType+"}":"")+" expected"}function $t(r,t,e,n){if(t.resolvedType)if(t.resolvedType instanceof ts){r("switch(%s){",n)("default:")("return%j",j(t,"enum value"));for(var i=Object.keys(t.resolvedType.values),s=0;s<i.length;++s)r("case %i:",t.resolvedType.values[i[s]]);r("break")("}")}else r("{")("var e=types[%i].verify(%s);",e,n)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":r("if(!util.isInteger(%s))",n)("return%j",j(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":r("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",j(t,"integer|Long"));break;case"float":case"double":r('if(typeof %s!=="number")',n)("return%j",j(t,"number"));break;case"bool":r('if(typeof %s!=="boolean")',n)("return%j",j(t,"boolean"));break;case"string":r("if(!util.isString(%s))",n)("return%j",j(t,"string"));break;case"bytes":r('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",j(t,"buffer"));break}return r}function ns(r,t,e){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":r("if(!util.key32Re.test(%s))",e)("return%j",j(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":r("if(!util.key64Re.test(%s))",e)("return%j",j(t,"integer|Long key"));break;case"bool":r("if(!util.key2Re.test(%s))",e)("return%j",j(t,"boolean key"));break}return r}function rs(r){var t=Wt.codegen(["m"],r.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),e=r.oneofsArray,n={};e.length&&t("var p={}");for(var i=0;i<r.fieldsArray.length;++i){var s=r._fieldsArray[i].resolve(),o="m"+Wt.safeProp(s.name);if(s.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)t("if(!util.isObject(%s))",o)("return%j",j(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),ns(t,s,"k[i]"),$t(t,s,i,o+"[k[i]]")("}");else if(s.repeated)t("if(!Array.isArray(%s))",o)("return%j",j(s,"array"))("for(var i=0;i<%s.length;++i){",o),$t(t,s,i,o+"[i]")("}");else{if(s.partOf){var a=Wt.safeProp(s.partOf.name);n[s.partOf.name]===1&&t("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),n[s.partOf.name]=1,t("p%s=1",a)}$t(t,s,i,o)}s.optional&&t("}")}return t("return null")}});var Zt=d($r=>{"use strict";var Wr=$r,Ae=H(),K=C();function Vt(r,t,e,n){var i=!1;if(t.resolvedType)if(t.resolvedType instanceof Ae){r("switch(d%s){",n);for(var s=t.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===t.typeDefault&&!i&&(r("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',n,n,n),t.repeated||r("break"),i=!0),r("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",n,s[o[a]])("break");r("}")}else r('if(typeof d%s!=="object")',n)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,e,n);else{var u=!1;switch(t.type){case"double":case"float":r("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":r("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":r("m%s=d%s|0",n,n);break;case"uint64":u=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":r("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,u)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,u?"true":"");break;case"bytes":r('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":r("m%s=String(d%s)",n,n);break;case"bool":r("m%s=Boolean(d%s)",n,n);break}}return r}Wr.fromObject=function(t){var e=t.fieldsArray,n=K.codegen(["d"],t.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!e.length)return n("return new this.ctor");n("var m=new this.ctor");for(var i=0;i<e.length;++i){var s=e[i].resolve(),o=K.safeProp(s.name);s.map?(n("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),Vt(n,s,i,o+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),Vt(n,s,i,o+"[i]")("}")("}")):(s.resolvedType instanceof Ae||n("if(d%s!=null){",o),Vt(n,s,i,o),s.resolvedType instanceof Ae||n("}"))}return n("return m")};function Kt(r,t,e,n){if(t.resolvedType)t.resolvedType instanceof Ae?r("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",n,e,n,n,e,n,n):r("d%s=types[%i].toObject(m%s,o)",n,e,n);else{var i=!1;switch(t.type){case"double":case"float":r("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":r('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,i?"true":"",n);break;case"bytes":r("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:r("d%s=m%s",n,n);break}}return r}Wr.toObject=function(t){var e=t.fieldsArray.slice().sort(K.compareFieldsById);if(!e.length)return K.codegen()("return {}");for(var n=K.codegen(["m","o"],t.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],o=[],a=0;a<e.length;++a)e[a].partOf||(e[a].resolve().repeated?i:e[a].map?s:o).push(e[a]);if(i.length){for(n("if(o.arrays||o.defaults){"),a=0;a<i.length;++a)n("d%s=[]",K.safeProp(i[a].name));n("}")}if(s.length){for(n("if(o.objects||o.defaults){"),a=0;a<s.length;++a)n("d%s={}",K.safeProp(s[a].name));n("}")}if(o.length){for(n("if(o.defaults){"),a=0;a<o.length;++a){var u=o[a],c=K.safeProp(u.name);if(u.resolvedType instanceof Ae)n("d%s=o.enums===String?%j:%j",c,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var l="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",c,l)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else n("d%s=%j",c,u.typeDefault)}n("}")}var b=!1;for(a=0;a<e.length;++a){var u=e[a],x=t._fieldsArray.indexOf(u),c=K.safeProp(u.name);u.map?(b||(b=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),Kt(n,u,x,c+"[ks2[j]]")("}")):u.repeated?(n("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),Kt(n,u,x,c+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",c,u.name),Kt(n,u,x,c),u.partOf&&n("if(o.oneofs)")("d%s=%j",K.safeProp(u.partOf.name),u.name)),n("}")}return n("return d")}});var Gt=d(Hr=>{"use strict";var is=Hr,ss=Ye();is[".google.protobuf.Any"]={fromObject:function(r){if(r&&r["@type"]){var t=r["@type"].substring(r["@type"].lastIndexOf("/")+1),e=this.lookup(t);if(e){var n=r["@type"].charAt(0)==="."?r["@type"].slice(1):r["@type"];return n.indexOf("/")===-1&&(n="/"+n),this.create({type_url:n,value:e.encode(e.fromObject(r)).finish()})}}return this.fromObject(r)},toObject:function(r,t){var e="type.googleapis.com/",n="",i="";if(t&&t.json&&r.type_url&&r.value){i=r.type_url.substring(r.type_url.lastIndexOf("/")+1),n=r.type_url.substring(0,r.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(r=s.decode(r.value))}if(!(r instanceof this.ctor)&&r instanceof ss){var o=r.$type.toObject(r,t),a=r.$type.fullName[0]==="."?r.$type.fullName.slice(1):r.$type.fullName;return n===""&&(n=e),i=n+a,o["@type"]=i,o}return this.toObject(r,t)}}});var en=d((sa,Kr)=>{"use strict";Kr.exports=O;var U=me();((O.prototype=Object.create(U.prototype)).constructor=O).className="Type";var os=H(),Yt=ke(),et=oe(),as=jt(),us=Ut(),Xt=Ye(),Qt=Ke(),cs=He(),P=C(),ls=tn(),fs=zt(),hs=Ht(),Vr=Zt(),ds=Gt();function O(r,t){U.call(this,r,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(O.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var r=Object.keys(this.fields),t=0;t<r.length;++t){var e=this.fields[r[t]],n=e.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=e}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=P.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=P.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=O.generateConstructor(this)())},set:function(r){var t=r.prototype;t instanceof Xt||((r.prototype=new Xt).constructor=r,P.merge(r.prototype,t)),r.$type=r.prototype.$type=this,P.merge(r,Xt,!0),this._ctor=r;for(var e=0;e<this.fieldsArray.length;++e)this._fieldsArray[e].resolve();var n={};for(e=0;e<this.oneofsArray.length;++e)n[this._oneofsArray[e].resolve().name]={get:P.oneOfGetter(this._oneofsArray[e].oneof),set:P.oneOfSetter(this._oneofsArray[e].oneof)};e&&Object.defineProperties(r.prototype,n)}}});O.generateConstructor=function(t){for(var e=P.codegen(["p"],t.name),n=0,i;n<t.fieldsArray.length;++n)(i=t._fieldsArray[n]).map?e("this%s={}",P.safeProp(i.name)):i.repeated&&e("this%s=[]",P.safeProp(i.name));return e("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function tt(r){return r._fieldsById=r._fieldsArray=r._oneofsArray=null,delete r.encode,delete r.decode,delete r.verify,r}O.fromJSON=function(t,e){var n=new O(t,e.options);n.extensions=e.extensions,n.reserved=e.reserved;for(var i=Object.keys(e.fields),s=0;s<i.length;++s)n.add((typeof e.fields[i[s]].keyType<"u"?as.fromJSON:et.fromJSON)(i[s],e.fields[i[s]]));if(e.oneofs)for(i=Object.keys(e.oneofs),s=0;s<i.length;++s)n.add(Yt.fromJSON(i[s],e.oneofs[i[s]]));if(e.nested)for(i=Object.keys(e.nested),s=0;s<i.length;++s){var o=e.nested[i[s]];n.add((o.id!==void 0?et.fromJSON:o.fields!==void 0?O.fromJSON:o.values!==void 0?os.fromJSON:o.methods!==void 0?us.fromJSON:U.fromJSON)(i[s],o))}return e.extensions&&e.extensions.length&&(n.extensions=e.extensions),e.reserved&&e.reserved.length&&(n.reserved=e.reserved),e.group&&(n.group=!0),e.comment&&(n.comment=e.comment),n};O.prototype.toJSON=function(t){var e=U.prototype.toJSON.call(this,t),n=t?!!t.keepComments:!1;return P.toObject(["options",e&&e.options||void 0,"oneofs",U.arrayToJSON(this.oneofsArray,t),"fields",U.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),t)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",e&&e.nested||void 0,"comment",n?this.comment:void 0])};O.prototype.resolveAll=function(){for(var t=this.fieldsArray,e=0;e<t.length;)t[e++].resolve();var n=this.oneofsArray;for(e=0;e<n.length;)n[e++].resolve();return U.prototype.resolveAll.call(this)};O.prototype.get=function(t){return this.fields[t]||this.oneofs&&this.oneofs[t]||this.nested&&this.nested[t]||null};O.prototype.add=function(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);if(t instanceof et&&t.extend===void 0){if(this._fieldsById?this._fieldsById[t.id]:this.fieldsById[t.id])throw Error("duplicate id "+t.id+" in "+this);if(this.isReservedId(t.id))throw Error("id "+t.id+" is reserved in "+this);if(this.isReservedName(t.name))throw Error("name '"+t.name+"' is reserved in "+this);return t.parent&&t.parent.remove(t),this.fields[t.name]=t,t.message=this,t.onAdd(this),tt(this)}return t instanceof Yt?(this.oneofs||(this.oneofs={}),this.oneofs[t.name]=t,t.onAdd(this),tt(this)):U.prototype.add.call(this,t)};O.prototype.remove=function(t){if(t instanceof et&&t.extend===void 0){if(!this.fields||this.fields[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.fields[t.name],t.parent=null,t.onRemove(this),tt(this)}if(t instanceof Yt){if(!this.oneofs||this.oneofs[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.oneofs[t.name],t.parent=null,t.onRemove(this),tt(this)}return U.prototype.remove.call(this,t)};O.prototype.isReservedId=function(t){return U.isReservedId(this.reserved,t)};O.prototype.isReservedName=function(t){return U.isReservedName(this.reserved,t)};O.prototype.create=function(t){return new this.ctor(t)};O.prototype.setup=function(){for(var t=this.fullName,e=[],n=0;n<this.fieldsArray.length;++n)e.push(this._fieldsArray[n].resolve().resolvedType);this.encode=ls(this)({Writer:cs,types:e,util:P}),this.decode=fs(this)({Reader:Qt,types:e,util:P}),this.verify=hs(this)({types:e,util:P}),this.fromObject=Vr.fromObject(this)({types:e,util:P}),this.toObject=Vr.toObject(this)({types:e,util:P});var i=ds[t];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};O.prototype.encode=function(t,e){return this.setup().encode(t,e)};O.prototype.encodeDelimited=function(t,e){return this.encode(t,e&&e.len?e.fork():e).ldelim()};O.prototype.decode=function(t,e){return this.setup().decode(t,e)};O.prototype.decodeDelimited=function(t){return t instanceof Qt||(t=Qt.create(t)),this.decode(t,t.uint32())};O.prototype.verify=function(t){return this.setup().verify(t)};O.prototype.fromObject=function(t){return this.setup().fromObject(t)};O.prototype.toObject=function(t,e){return this.setup().toObject(t,e)};O.d=function(t){return function(n){P.decorateType(n,t)}}});var sn=d((oa,Yr)=>{"use strict";Yr.exports=q;var rt=me();((q.prototype=Object.create(rt.prototype)).constructor=q).className="Root";var rn=oe(),Gr=H(),ps=ke(),te=C(),Xr,nn,qe;function q(r){rt.call(this,"",r),this.deferred=[],this.files=[]}q.fromJSON=function(t,e){return e||(e=new q),t.options&&e.setOptions(t.options),e.addJSON(t.nested)};q.prototype.resolvePath=te.path.resolve;q.prototype.fetch=te.fetch;function Qr(){}q.prototype.load=function r(t,e,n){typeof e=="function"&&(n=e,e=void 0);var i=this;if(!n)return te.asPromise(r,i,t,e);var s=n===Qr;function o(p,h){if(n){var y=n;if(n=null,s)throw p;y(p,h)}}function a(p){var h=p.lastIndexOf("google/protobuf/");if(h>-1){var y=p.substring(h);if(y in qe)return y}return null}function u(p,h){try{if(te.isString(h)&&h.charAt(0)==="{"&&(h=JSON.parse(h)),!te.isString(h))i.setOptions(h.options).addJSON(h.nested);else{nn.filename=p;var y=nn(h,i,e),v,w=0;if(y.imports)for(;w<y.imports.length;++w)(v=a(y.imports[w])||i.resolvePath(p,y.imports[w]))&&c(v);if(y.weakImports)for(w=0;w<y.weakImports.length;++w)(v=a(y.weakImports[w])||i.resolvePath(p,y.weakImports[w]))&&c(v,!0)}}catch(ge){o(ge)}!s&&!l&&o(null,i)}function c(p,h){if(p=a(p)||p,!(i.files.indexOf(p)>-1)){if(i.files.push(p),p in qe){s?u(p,qe[p]):(++l,setTimeout(function(){--l,u(p,qe[p])}));return}if(s){var y;try{y=te.fs.readFileSync(p).toString("utf8")}catch(v){h||o(v);return}u(p,y)}else++l,i.fetch(p,function(v,w){if(--l,!!n){if(v){h?l||o(null,i):o(v);return}u(p,w)}})}}var l=0;te.isString(t)&&(t=[t]);for(var b=0,x;b<t.length;++b)(x=i.resolvePath("",t[b]))&&c(x);if(s)return i;l||o(null,i)};q.prototype.loadSync=function(t,e){if(!te.isNode)throw Error("not supported");return this.load(t,e,Qr)};q.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(t){return"'extend "+t.extend+"' in "+t.parent.fullName}).join(", "));return rt.prototype.resolveAll.call(this)};var nt=/^[A-Z]/;function Zr(r,t){var e=t.parent.lookup(t.extend);if(e){var n=new rn(t.fullName,t.id,t.type,t.rule,void 0,t.options);return e.get(n.name)||(n.declaringField=t,t.extensionField=n,e.add(n)),!0}return!1}q.prototype._handleAdd=function(t){if(t instanceof rn)t.extend!==void 0&&!t.extensionField&&(Zr(this,t)||this.deferred.push(t));else if(t instanceof Gr)nt.test(t.name)&&(t.parent[t.name]=t.values);else if(!(t instanceof ps)){if(t instanceof Xr)for(var e=0;e<this.deferred.length;)Zr(this,this.deferred[e])?this.deferred.splice(e,1):++e;for(var n=0;n<t.nestedArray.length;++n)this._handleAdd(t._nestedArray[n]);nt.test(t.name)&&(t.parent[t.name]=t)}};q.prototype._handleRemove=function(t){if(t instanceof rn){if(t.extend!==void 0)if(t.extensionField)t.extensionField.parent.remove(t.extensionField),t.extensionField=null;else{var e=this.deferred.indexOf(t);e>-1&&this.deferred.splice(e,1)}}else if(t instanceof Gr)nt.test(t.name)&&delete t.parent[t.name];else if(t instanceof rt){for(var n=0;n<t.nestedArray.length;++n)this._handleRemove(t._nestedArray[n]);nt.test(t.name)&&delete t.parent[t.name]}};q._configure=function(r,t,e){Xr=r,nn=t,qe=e}});var C=d((aa,ti)=>{"use strict";var T=ti.exports=W(),ei=Pt(),on,an;T.codegen=br();T.fetch=wr();T.path=Or();T.fs=T.inquire("fs");T.toArray=function(t){if(t){for(var e=Object.keys(t),n=new Array(e.length),i=0;i<e.length;)n[i]=t[e[i++]];return n}return[]};T.toObject=function(t){for(var e={},n=0;n<t.length;){var i=t[n++],s=t[n++];s!==void 0&&(e[i]=s)}return e};var ys=/\\/g,ms=/"/g;T.isReserved=function(t){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(t)};T.safeProp=function(t){return!/^[$\w_]+$/.test(t)||T.isReserved(t)?'["'+t.replace(ys,"\\\\").replace(ms,'\\"')+'"]':"."+t};T.ucFirst=function(t){return t.charAt(0).toUpperCase()+t.substring(1)};var _s=/_([a-z])/g;T.camelCase=function(t){return t.substring(0,1)+t.substring(1).replace(_s,function(e,n){return n.toUpperCase()})};T.compareFieldsById=function(t,e){return t.id-e.id};T.decorateType=function(t,e){if(t.$type)return e&&t.$type.name!==e&&(T.decorateRoot.remove(t.$type),t.$type.name=e,T.decorateRoot.add(t.$type)),t.$type;on||(on=en());var n=new on(e||t.name);return T.decorateRoot.add(n),n.ctor=t,Object.defineProperty(t,"$type",{value:n,enumerable:!1}),Object.defineProperty(t.prototype,"$type",{value:n,enumerable:!1}),n};var gs=0;T.decorateEnum=function(t){if(t.$type)return t.$type;an||(an=H());var e=new an("Enum"+gs++,t);return T.decorateRoot.add(e),Object.defineProperty(t,"$type",{value:e,enumerable:!1}),e};T.setProperty=function(t,e,n){function i(s,o,a){var u=o.shift();if(u==="__proto__"||u==="prototype")return s;if(o.length>0)s[u]=i(s[u]||{},o,a);else{var c=s[u];c&&(a=[].concat(c).concat(a)),s[u]=a}return s}if(typeof t!="object")throw TypeError("dst must be an object");if(!e)throw TypeError("path must be specified");return e=e.split("."),i(t,e,n)};Object.defineProperty(T,"decorateRoot",{get:function(){return ei.decorated||(ei.decorated=new(sn()))}})});var ae=d((ua,ni)=>{"use strict";ni.exports=D;D.className="ReflectionObject";var it=C(),st;function D(r,t){if(!it.isString(r))throw TypeError("name must be a string");if(t&&!it.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=r,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(D.prototype,{root:{get:function(){for(var r=this;r.parent!==null;)r=r.parent;return r}},fullName:{get:function(){for(var r=[this.name],t=this.parent;t;)r.unshift(t.name),t=t.parent;return r.join(".")}}});D.prototype.toJSON=function(){throw Error()};D.prototype.onAdd=function(t){this.parent&&this.parent!==t&&this.parent.remove(this),this.parent=t,this.resolved=!1;var e=t.root;e instanceof st&&e._handleAdd(this)};D.prototype.onRemove=function(t){var e=t.root;e instanceof st&&e._handleRemove(this),this.parent=null,this.resolved=!1};D.prototype.resolve=function(){return this.resolved?this:(this.root instanceof st&&(this.resolved=!0),this)};D.prototype.getOption=function(t){if(this.options)return this.options[t]};D.prototype.setOption=function(t,e,n){return(!n||!this.options||this.options[t]===void 0)&&((this.options||(this.options={}))[t]=e),this};D.prototype.setParsedOption=function(t,e,n){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(n){var s=i.find(function(u){return Object.prototype.hasOwnProperty.call(u,t)});if(s){var o=s[t];it.setProperty(o,n,e)}else s={},s[t]=it.setProperty({},n,e),i.push(s)}else{var a={};a[t]=e,i.push(a)}return this};D.prototype.setOptions=function(t,e){if(t)for(var n=Object.keys(t),i=0;i<n.length;++i)this.setOption(n[i],t[n[i]],e);return this};D.prototype.toString=function(){var t=this.constructor.className,e=this.fullName;return e.length?t+" "+e:t};D._configure=function(r){st=r}});var H=d((ca,si)=>{"use strict";si.exports=Z;var ri=ae();((Z.prototype=Object.create(ri.prototype)).constructor=Z).className="Enum";var ii=me(),ot=C();function Z(r,t,e,n,i,s){if(ri.call(this,r,e),t&&typeof t!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=n,this.comments=i||{},this.valuesOptions=s,this.reserved=void 0,t)for(var o=Object.keys(t),a=0;a<o.length;++a)typeof t[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=t[o[a]]]=o[a])}Z.fromJSON=function(t,e){var n=new Z(t,e.values,e.options,e.comment,e.comments);return n.reserved=e.reserved,n};Z.prototype.toJSON=function(t){var e=t?!!t.keepComments:!1;return ot.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",e?this.comment:void 0,"comments",e?this.comments:void 0])};Z.prototype.add=function(t,e,n,i){if(!ot.isString(t))throw TypeError("name must be a string");if(!ot.isInteger(e))throw TypeError("id must be an integer");if(this.values[t]!==void 0)throw Error("duplicate name '"+t+"' in "+this);if(this.isReservedId(e))throw Error("id "+e+" is reserved in "+this);if(this.isReservedName(t))throw Error("name '"+t+"' is reserved in "+this);if(this.valuesById[e]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+e+" in "+this);this.values[t]=e}else this.valuesById[this.values[t]=e]=t;return i&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[t]=i||null),this.comments[t]=n||null,this};Z.prototype.remove=function(t){if(!ot.isString(t))throw TypeError("name must be a string");var e=this.values[t];if(e==null)throw Error("name '"+t+"' does not exist in "+this);return delete this.valuesById[e],delete this.values[t],delete this.comments[t],this.valuesOptions&&delete this.valuesOptions[t],this};Z.prototype.isReservedId=function(t){return ii.isReservedId(this.reserved,t)};Z.prototype.isReservedName=function(t){return ii.isReservedName(this.reserved,t)}});var tn=d((la,ai)=>{"use strict";ai.exports=vs;var bs=H(),un=de(),cn=C();function oi(r,t,e,n){return t.resolvedType.group?r("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",e,n,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):r("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",e,n,(t.id<<3|2)>>>0)}function vs(r){for(var t=cn.codegen(["m","w"],r.name+"$encode")("if(!w)")("w=Writer.create()"),e,n,i=r.fieldsArray.slice().sort(cn.compareFieldsById),e=0;e<i.length;++e){var s=i[e].resolve(),o=r._fieldsArray.indexOf(s),a=s.resolvedType instanceof bs?"int32":s.type,u=un.basic[a];n="m"+cn.safeProp(s.name),s.map?(t("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",n,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",n)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|un.mapKey[s.keyType],s.keyType),u===void 0?t("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,n):t(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|u,a,n),t("}")("}")):s.repeated?(t("if(%s!=null&&%s.length){",n,n),s.packed&&un.packed[a]!==void 0?t("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",n)("w.%s(%s[i])",a,n)("w.ldelim()"):(t("for(var i=0;i<%s.length;++i)",n),u===void 0?oi(t,s,o,n+"[i]"):t("w.uint32(%i).%s(%s[i])",(s.id<<3|u)>>>0,a,n)),t("}")):(s.optional&&t("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",n,s.name),u===void 0?oi(t,s,o,n):t("w.uint32(%i).%s(%s)",(s.id<<3|u)>>>0,a,n))}return t("return w")}});var ci=d((fa,ui)=>{"use strict";var m=ui.exports=_r();m.build="light";function ws(r,t,e){return typeof t=="function"?(e=t,t=new m.Root):t||(t=new m.Root),t.load(r,e)}m.load=ws;function Ss(r,t){return t||(t=new m.Root),t.loadSync(r)}m.loadSync=Ss;m.encoder=tn();m.decoder=zt();m.verifier=Ht();m.converter=Zt();m.ReflectionObject=ae();m.Namespace=me();m.Root=sn();m.Enum=H();m.Type=en();m.Field=oe();m.OneOf=ke();m.MapField=jt();m.Service=Ut();m.Method=Jt();m.Message=Ye();m.wrappers=Gt();m.types=de();m.util=C();m.ReflectionObject._configure(m.Root);m.Namespace._configure(m.Type,m.Service,m.Enum);m.Root._configure(m.Type);m.Field._configure(m.Type)});var fi=d((ha,li)=>{"use strict";li.exports=ci()});var En=lt(ht());var Le=(n=>(n.Disconnected="disconnected",n.Connecting="connecting",n.Connected="connected",n))(Le||{}),Ie=(n=>(n.Unsubscribed="unsubscribed",n.Subscribing="subscribing",n.Subscribed="subscribed",n))(Ie||{});function Sn(r,t){return r.lastIndexOf(t,0)===0}function dt(r){return r==null?!1:typeof r=="function"}function xn(r,t){if(globalThis.console){let e=globalThis.console[r];dt(e)&&e.apply(globalThis.console,t)}}function ki(r,t){return Math.floor(Math.random()*(t-r+1)+r)}function le(r,t,e){r>31&&(r=31);let n=ki(0,Math.min(e,t*Math.pow(2,r)));return Math.min(e,t+n)}function On(r){return"error"in r&&r.error!==null}function fe(r){return Math.min(r*1e3,2147483647)}var Be=class extends En.default{constructor(e,n,i){super();this._resubscribeTimeout=null;this._refreshTimeout=null;this.channel=n,this.state="unsubscribed",this._centrifuge=e,this._token="",this._getToken=null,this._data=null,this._getData=null,this._recover=!1,this._offset=null,this._epoch=null,this._recoverable=!1,this._positioned=!1,this._joinLeave=!1,this._minResubscribeDelay=500,this._maxResubscribeDelay=2e4,this._resubscribeTimeout=null,this._resubscribeAttempts=0,this._promises={},this._promiseId=0,this._inflight=!1,this._refreshTimeout=null,this._delta="",this._delta_negotiated=!1,this._prevValue=null,this._setOptions(i),this._centrifuge._debugEnabled?(this.on("state",s=>{this._centrifuge._debug("subscription state",n,s.oldState,"->",s.newState)}),this.on("error",s=>{this._centrifuge._debug("subscription error",n,s)})):this.on("error",function(){Function.prototype()})}ready(e){return this.state==="unsubscribed"?Promise.reject({code:7,message:this.state}):this.state==="subscribed"?Promise.resolve():new Promise((n,i)=>{let s={resolve:n,reject:i};e&&(s.timeout=setTimeout(function(){i({code:1,message:"timeout"})},e)),this._promises[this._nextPromiseId()]=s})}subscribe(){this._isSubscribed()||(this._resubscribeAttempts=0,this._setSubscribing(0,"subscribe called"))}unsubscribe(){this._setUnsubscribed(0,"unsubscribe called",!0)}publish(e){let n=this;return this._methodCall().then(function(){return n._centrifuge.publish(n.channel,e)})}presence(){let e=this;return this._methodCall().then(function(){return e._centrifuge.presence(e.channel)})}presenceStats(){let e=this;return this._methodCall().then(function(){return e._centrifuge.presenceStats(e.channel)})}history(e){let n=this;return this._methodCall().then(function(){return n._centrifuge.history(n.channel,e)})}_methodCall(){return this._isSubscribed()?Promise.resolve():this._isUnsubscribed()?Promise.reject({code:7,message:this.state}):new Promise((e,n)=>{let i=setTimeout(function(){n({code:1,message:"timeout"})},this._centrifuge._config.timeout);this._promises[this._nextPromiseId()]={timeout:i,resolve:e,reject:n}})}_nextPromiseId(){return++this._promiseId}_needRecover(){return this._recover===!0}_isUnsubscribed(){return this.state==="unsubscribed"}_isSubscribing(){return this.state==="subscribing"}_isSubscribed(){return this.state==="subscribed"}_setState(e){if(this.state!==e){let n=this.state;return this.state=e,this.emit("state",{newState:e,oldState:n,channel:this.channel}),!0}return!1}_usesToken(){return this._token!==""||this._getToken!==null}_clearSubscribingState(){this._resubscribeAttempts=0,this._clearResubscribeTimeout()}_clearSubscribedState(){this._clearRefreshTimeout()}_setSubscribed(e){if(!this._isSubscribing())return;this._clearSubscribingState(),e.recoverable&&(this._recover=!0,this._offset=e.offset||0,this._epoch=e.epoch||""),e.delta?this._delta_negotiated=!0:this._delta_negotiated=!1,this._setState("subscribed");let n=this._centrifuge._getSubscribeContext(this.channel,e);this.emit("subscribed",n),this._resolvePromises();let i=e.publications;if(i&&i.length>0)for(let s in i)i.hasOwnProperty(s)&&this._handlePublication(i[s]);e.expires===!0&&(this._refreshTimeout=setTimeout(()=>this._refresh(),fe(e.ttl)))}_setSubscribing(e,n){this._isSubscribing()||(this._isSubscribed()&&this._clearSubscribedState(),this._setState("subscribing")&&this.emit("subscribing",{channel:this.channel,code:e,reason:n}),this._subscribe())}_subscribe(){if(this._centrifuge._debug("subscribing on",this.channel),!this._centrifuge._transportIsOpen)return this._centrifuge._debug("delay subscribe on",this.channel,"till connected"),null;let e=this,n={channel:e.channel};return!this._usesToken()||this._token?e._getData?(e._getData(n).then(function(i){e._isSubscribing()&&(e._data=i,e._sendSubscribe(e._token))}),null):e._sendSubscribe(e._token):(this._getSubscriptionToken().then(function(i){if(e._isSubscribing()){if(!i){e._failUnauthorized();return}e._token=i,e._getData?e._getData(n).then(function(s){e._isSubscribing()&&(e._data=s,e._sendSubscribe(i))}):e._sendSubscribe(i)}}).catch(function(i){if(e._isSubscribing()){if(i instanceof z){e._failUnauthorized();return}e.emit("error",{type:"subscribeToken",channel:e.channel,error:{code:8,message:i!==void 0?i.toString():""}}),e._scheduleResubscribe()}}),null)}_sendSubscribe(e){if(!this._centrifuge._transportIsOpen)return null;let i={channel:this.channel};if(e&&(i.token=e),this._data&&(i.data=this._data),this._positioned&&(i.positioned=!0),this._recoverable&&(i.recoverable=!0),this._joinLeave&&(i.join_leave=!0),this._needRecover()){i.recover=!0;let o=this._getOffset();o&&(i.offset=o);let a=this._getEpoch();a&&(i.epoch=a)}this._delta&&(i.delta=this._delta);let s={subscribe:i};return this._inflight=!0,this._centrifuge._call(s).then(o=>{this._inflight=!1;let a=o.reply.subscribe;this._handleSubscribeResponse(a),o.next&&o.next()},o=>{this._inflight=!1,this._handleSubscribeError(o.error),o.next&&o.next()}),s}_handleSubscribeError(e){if(this._isSubscribing()){if(e.code===1){this._centrifuge._disconnect(3,"subscribe timeout",!0);return}this._subscribeError(e)}}_handleSubscribeResponse(e){this._isSubscribing()&&this._setSubscribed(e)}_setUnsubscribed(e,n,i){this._isUnsubscribed()||(this._isSubscribed()&&(i&&this._centrifuge._unsubscribe(this),this._clearSubscribedState()),this._isSubscribing()&&(this._inflight&&i&&this._centrifuge._unsubscribe(this),this._clearSubscribingState()),this._setState("unsubscribed")&&this.emit("unsubscribed",{channel:this.channel,code:e,reason:n}),this._rejectPromises({code:7,message:this.state}))}_handlePublication(e){if(this._delta&&this._delta_negotiated){let{newData:i,newPrevValue:s}=this._centrifuge._codec.applyDeltaIfNeeded(e,this._prevValue);e.data=i,this._prevValue=s}let n=this._centrifuge._getPublicationContext(this.channel,e);this.emit("publication",n),e.offset&&(this._offset=e.offset)}_handleJoin(e){let n=this._centrifuge._getJoinLeaveContext(e.info);this.emit("join",{channel:this.channel,info:n})}_handleLeave(e){let n=this._centrifuge._getJoinLeaveContext(e.info);this.emit("leave",{channel:this.channel,info:n})}_resolvePromises(){for(let e in this._promises)this._promises.hasOwnProperty(e)&&(this._promises[e].timeout&&clearTimeout(this._promises[e].timeout),this._promises[e].resolve(),delete this._promises[e])}_rejectPromises(e){for(let n in this._promises)this._promises.hasOwnProperty(n)&&(this._promises[n].timeout&&clearTimeout(this._promises[n].timeout),this._promises[n].reject(e),delete this._promises[n])}_scheduleResubscribe(){let e=this,n=this._getResubscribeDelay();this._resubscribeTimeout=setTimeout(function(){e._isSubscribing()&&e._subscribe()},n)}_subscribeError(e){if(this._isSubscribing())if(e.code<100||e.code===109||e.temporary===!0){e.code===109&&(this._token="");let n={channel:this.channel,type:"subscribe",error:e};this._centrifuge.state==="connected"&&this.emit("error",n),this._scheduleResubscribe()}else this._setUnsubscribed(e.code,e.message,!1)}_getResubscribeDelay(){let e=le(this._resubscribeAttempts,this._minResubscribeDelay,this._maxResubscribeDelay);return this._resubscribeAttempts++,e}_setOptions(e){if(e&&(e.since&&(this._offset=e.since.offset,this._epoch=e.since.epoch,this._recover=!0),e.data&&(this._data=e.data),e.getData&&(this._getData=e.getData),e.minResubscribeDelay!==void 0&&(this._minResubscribeDelay=e.minResubscribeDelay),e.maxResubscribeDelay!==void 0&&(this._maxResubscribeDelay=e.maxResubscribeDelay),e.token&&(this._token=e.token),e.getToken&&(this._getToken=e.getToken),e.positioned===!0&&(this._positioned=!0),e.recoverable===!0&&(this._recoverable=!0),e.joinLeave===!0&&(this._joinLeave=!0),e.delta)){if(e.delta!=="fossil")throw new Error("unsupported delta format");this._delta=e.delta}}_getOffset(){let e=this._offset;return e!==null?e:0}_getEpoch(){let e=this._epoch;return e!==null?e:""}_clearRefreshTimeout(){this._refreshTimeout!==null&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null)}_clearResubscribeTimeout(){this._resubscribeTimeout!==null&&(clearTimeout(this._resubscribeTimeout),this._resubscribeTimeout=null)}_getSubscriptionToken(){this._centrifuge._debug("get subscription token for channel",this.channel);let e={channel:this.channel},n=this._getToken;if(n===null)throw this.emit("error",{type:"configuration",channel:this.channel,error:{code:12,message:"provide a function to get channel subscription token"}}),new z("");return n(e)}_refresh(){this._clearRefreshTimeout();let e=this;this._getSubscriptionToken().then(function(n){if(!e._isSubscribed())return;if(!n){e._failUnauthorized();return}e._token=n;let s={sub_refresh:{channel:e.channel,token:n}};e._centrifuge._call(s).then(o=>{let a=o.reply.sub_refresh;e._refreshResponse(a),o.next&&o.next()},o=>{e._refreshError(o.error),o.next&&o.next()})}).catch(function(n){if(n instanceof z){e._failUnauthorized();return}e.emit("error",{type:"refreshToken",channel:e.channel,error:{code:9,message:n!==void 0?n.toString():""}}),e._refreshTimeout=setTimeout(()=>e._refresh(),e._getRefreshRetryDelay())})}_refreshResponse(e){this._isSubscribed()&&(this._centrifuge._debug("subscription token refreshed, channel",this.channel),this._clearRefreshTimeout(),e.expires===!0&&(this._refreshTimeout=setTimeout(()=>this._refresh(),fe(e.ttl))))}_refreshError(e){this._isSubscribed()&&(e.code<100||e.temporary===!0?(this.emit("error",{type:"refresh",channel:this.channel,error:e}),this._refreshTimeout=setTimeout(()=>this._refresh(),this._getRefreshRetryDelay())):this._setUnsubscribed(e.code,e.message,!0))}_getRefreshRetryDelay(){return le(0,1e4,2e4)}_failUnauthorized(){this._setUnsubscribed(1,"unauthorized",!0)}};var je=class{constructor(t,e){this.endpoint=t,this.options=e,this._transport=null}name(){return"sockjs"}subName(){return"sockjs-"+this._transport.transport}emulation(){return!1}supported(){return this.options.sockjs!==null}initialize(t,e){this._transport=new this.options.sockjs(this.endpoint,null,this.options.sockjsOptions),this._transport.onopen=()=>{e.onOpen()},this._transport.onerror=n=>{e.onError(n)},this._transport.onclose=n=>{e.onClose(n)},this._transport.onmessage=n=>{e.onMessage(n.data)}}close(){this._transport.close()}send(t){this._transport.send(t)}};var be=class{constructor(t,e){this.endpoint=t,this.options=e,this._transport=null}name(){return"websocket"}subName(){return"websocket"}emulation(){return!1}supported(){return this.options.websocket!==void 0&&this.options.websocket!==null}initialize(t,e){let n="";t==="protobuf"&&(n="centrifuge-protobuf"),n!==""?this._transport=new this.options.websocket(this.endpoint,n):this._transport=new this.options.websocket(this.endpoint),t==="protobuf"&&(this._transport.binaryType="arraybuffer"),this._transport.onopen=()=>{e.onOpen()},this._transport.onerror=i=>{e.onError(i)},this._transport.onclose=i=>{e.onClose(i)},this._transport.onmessage=i=>{e.onMessage(i.data)}}close(){this._transport.close()}send(t){this._transport.send(t)}};var Fe=class{constructor(t,e){this.endpoint=t,this.options=e,this._abortController=null,this._utf8decoder=new TextDecoder,this._protocol="json"}name(){return"http_stream"}subName(){return"http_stream"}emulation(){return!0}_handleErrors(t){if(!t.ok)throw new Error(t.status);return t}_fetchEventTarget(t,e,n){let i=new EventTarget,s=t.options.fetch;return s(e,n).then(t._handleErrors).then(o=>{i.dispatchEvent(new Event("open"));let a="",u=0,c=new Uint8Array,l=o.body.getReader();return new t.options.readableStream({start(b){function x(){return l.read().then(({done:p,value:h})=>{if(p){i.dispatchEvent(new Event("close")),b.close();return}try{if(t._protocol==="json")for(a+=t._utf8decoder.decode(h);u<a.length;)if(a[u]===`
`){let y=a.substring(0,u);i.dispatchEvent(new MessageEvent("message",{data:y})),a=a.substring(u+1),u=0}else++u;else{let y=new Uint8Array(c.length+h.length);for(y.set(c),y.set(h,c.length),c=y;;){let v=t.options.decoder.decodeReply(c);if(v.ok){let w=c.slice(0,v.pos);i.dispatchEvent(new MessageEvent("message",{data:w})),c=c.slice(v.pos);continue}break}}}catch(y){i.dispatchEvent(new Event("error",{detail:y})),i.dispatchEvent(new Event("close")),b.close();return}x()}).catch(function(p){i.dispatchEvent(new Event("error",{detail:p})),i.dispatchEvent(new Event("close")),b.close()})}return x()}})}).catch(o=>{i.dispatchEvent(new Event("error",{detail:o})),i.dispatchEvent(new Event("close"))}),i}supported(){return this.options.fetch!==null&&this.options.readableStream!==null&&typeof TextDecoder<"u"&&typeof AbortController<"u"&&typeof EventTarget<"u"&&typeof Event<"u"&&typeof MessageEvent<"u"&&typeof Error<"u"}initialize(t,e,n){this._protocol=t,this._abortController=new AbortController;let i,s;t==="json"?(i={Accept:"application/json","Content-Type":"application/json"},s=n):(i={Accept:"application/octet-stream","Content-Type":"application/octet-stream"},s=n);let o={method:"POST",headers:i,body:s,mode:"cors",credentials:"same-origin",cache:"no-cache",signal:this._abortController.signal},a=this._fetchEventTarget(this,this.endpoint,o);a.addEventListener("open",()=>{e.onOpen()}),a.addEventListener("error",u=>{this._abortController.abort(),e.onError(u)}),a.addEventListener("close",()=>{this._abortController.abort(),e.onClose({code:4,reason:"connection closed"})}),a.addEventListener("message",u=>{e.onMessage(u.data)})}close(){this._abortController.abort()}send(t,e,n){let i,s,o={session:e,node:n,data:t};this._protocol==="json"?(i={"Content-Type":"application/json"},s=JSON.stringify(o)):(i={"Content-Type":"application/octet-stream"},s=this.options.encoder.encodeEmulationRequest(o));let a=this.options.fetch,u={method:"POST",headers:i,body:s,mode:"cors",credentials:"same-origin",cache:"no-cache"};a(this.options.emulationEndpoint,u)}};var Je=class{constructor(t,e){this.endpoint=t,this.options=e,this._protocol="json",this._transport=null,this._onClose=null}name(){return"sse"}subName(){return"sse"}emulation(){return!0}supported(){return this.options.eventsource!==null&&this.options.fetch!==null}initialize(t,e,n){let i;globalThis&&globalThis.document&&globalThis.document.baseURI?i=new URL(this.endpoint,globalThis.document.baseURI):i=new URL(this.endpoint),i.searchParams.append("cf_connect",n);let s={},o=new this.options.eventsource(i.toString(),s);this._transport=o;let a=this;o.onopen=function(){e.onOpen()},o.onerror=function(u){o.close(),e.onError(u),e.onClose({code:4,reason:"connection closed"})},o.onmessage=function(u){e.onMessage(u.data)},a._onClose=function(){e.onClose({code:4,reason:"connection closed"})}}close(){this._transport.close(),this._onClose!==null&&this._onClose()}send(t,e,n){let i={session:e,node:n,data:t},s={"Content-Type":"application/json"},o=JSON.stringify(i),a=this.options.fetch,u={method:"POST",headers:s,body:o,mode:"cors",credentials:"same-origin",cache:"no-cache"};a(this.options.emulationEndpoint,u)}};var Me=class{constructor(t,e){this.endpoint=t,this.options=e,this._transport=null,this._stream=null,this._writer=null,this._utf8decoder=new TextDecoder,this._protocol="json"}name(){return"webtransport"}subName(){return"webtransport"}emulation(){return!1}supported(){return this.options.webtransport!==void 0&&this.options.webtransport!==null}async initialize(t,e){let n;globalThis&&globalThis.document&&globalThis.document.baseURI?n=new URL(this.endpoint,globalThis.document.baseURI):n=new URL(this.endpoint),t==="protobuf"&&n.searchParams.append("cf_protocol","protobuf"),this._protocol=t;let i=new EventTarget;this._transport=new this.options.webtransport(n.toString()),this._transport.closed.then(()=>{e.onClose({code:4,reason:"connection closed"})}).catch(()=>{e.onClose({code:4,reason:"connection closed"})});try{await this._transport.ready}catch{this.close();return}let s;try{s=await this._transport.createBidirectionalStream()}catch{this.close();return}this._stream=s,this._writer=this._stream.writable.getWriter(),i.addEventListener("close",()=>{e.onClose({code:4,reason:"connection closed"})}),i.addEventListener("message",o=>{e.onMessage(o.data)}),this._startReading(i),e.onOpen()}async _startReading(t){let e=this._stream.readable.getReader(),n="",i=0,s=new Uint8Array;try{for(;;){let{done:o,value:a}=await e.read();if(a.length>0)if(this._protocol==="json")for(n+=this._utf8decoder.decode(a);i<n.length;)if(n[i]===`
`){let u=n.substring(0,i);t.dispatchEvent(new MessageEvent("message",{data:u})),n=n.substring(i+1),i=0}else++i;else{let u=new Uint8Array(s.length+a.length);for(u.set(s),u.set(a,s.length),s=u;;){let c=this.options.decoder.decodeReply(s);if(c.ok){let l=s.slice(0,c.pos);t.dispatchEvent(new MessageEvent("message",{data:l})),s=s.slice(c.pos);continue}break}}if(o)break}}catch{t.dispatchEvent(new Event("close"))}}async close(){try{this._writer&&await this._writer.close(),this._transport.close()}catch{}}async send(t){let e;this._protocol==="json"?e=new TextEncoder().encode(t+`
`):e=t;try{await this._writer.write(e)}catch{this.close()}}};var Ai=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,36,-1,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,-1,-1,-1,63,-1],pt=class{constructor(t){this.a=t,this.pos=0}haveBytes(){return this.pos<this.a.length}getByte(){let t=this.a[this.pos];if(this.pos++,this.pos>this.a.length)throw new RangeError("out of bounds");return t}getChar(){return String.fromCharCode(this.getByte())}getInt(){let t=0,e;for(;this.haveBytes()&&(e=Ai[127&this.getByte()])>=0;)t=(t<<6)+e;return this.pos--,t>>>0}},yt=class{constructor(){this.a=[]}toByteArray(t){return Array.isArray(t)?this.a:new Uint8Array(this.a)}putArray(t,e,n){this.a.push(...t.slice(e,n))}};function qi(r){let t=0,e=0,n=0,i=0,s=0,o=r.length;for(;o>=16;)t=t+r[s+0]|0,e=e+r[s+1]|0,n=n+r[s+2]|0,i=i+r[s+3]|0,t=t+r[s+4]|0,e=e+r[s+5]|0,n=n+r[s+6]|0,i=i+r[s+7]|0,t=t+r[s+8]|0,e=e+r[s+9]|0,n=n+r[s+10]|0,i=i+r[s+11]|0,t=t+r[s+12]|0,e=e+r[s+13]|0,n=n+r[s+14]|0,i=i+r[s+15]|0,s+=16,o-=16;for(;o>=4;)t=t+r[s+0]|0,e=e+r[s+1]|0,n=n+r[s+2]|0,i=i+r[s+3]|0,s+=4,o-=4;switch(i=((i+(n<<8)|0)+(e<<16)|0)+(t<<24)|0,o){case 3:i=i+(r[s+2]<<8)|0;case 2:i=i+(r[s+1]<<16)|0;case 1:i=i+(r[s+0]<<24)|0}return i>>>0}function Ue(r,t){let e=0,n=new pt(t),i=r.length,s=t.length,o=n.getInt();if(n.getChar()!==`
`)throw new Error("size integer not terminated by '\\n'");let a=new yt;for(;n.haveBytes();){let u=n.getInt(),c;switch(n.getChar()){case"@":if(c=n.getInt(),n.haveBytes()&&n.getChar()!==",")throw new Error("copy command not terminated by ','");if(e+=u,e>o)throw new Error("copy exceeds output file size");if(c+u>i)throw new Error("copy extends past end of input");a.putArray(r,c,c+u);break;case":":if(e+=u,e>o)throw new Error("insert command gives an output larger than predicted");if(u>s)throw new Error("insert count exceeds size of delta");a.putArray(n.a,n.pos,n.pos+u),n.pos+=u;break;case";":{let l=a.toByteArray(r);if(u!==qi(l))throw new Error("bad checksum");if(e!==o)throw new Error("generated size does not match predicted size");return l}default:throw new Error("unknown delta operator")}}throw new Error("unterminated delta")}var ve=class{name(){return"json"}encodeCommands(t){return t.map(e=>JSON.stringify(e)).join(`
`)}decodeReplies(t){return t.trim().split(`
`).map(e=>JSON.parse(e))}applyDeltaIfNeeded(t,e){let n,i;if(t.delta){let s=Ue(e,new TextEncoder().encode(t.data));n=JSON.parse(new TextDecoder().decode(s)),i=s}else n=JSON.parse(t.data),i=new TextEncoder().encode(t.data);return{newData:n,newPrevValue:i}}};var Tn=lt(ht()),Di={token:"",getToken:null,data:null,getData:null,debug:!1,name:"js",version:"",fetch:null,readableStream:null,websocket:null,eventsource:null,sockjs:null,sockjsOptions:{},emulationEndpoint:"/emulation",minReconnectDelay:500,maxReconnectDelay:2e4,timeout:5e3,maxServerPingDelay:1e4,networkEventTarget:null},z=class extends Error{constructor(t){super(t),this.name=this.constructor.name}},re=class extends Tn.default{constructor(e,n){super();this._reconnectTimeout=null;this._refreshTimeout=null;this._serverPingTimeout=null;this.state="disconnected",this._transportIsOpen=!1,this._endpoint=e,this._emulation=!1,this._transports=[],this._currentTransportIndex=0,this._triedAllTransports=!1,this._transportWasOpen=!1,this._transport=null,this._transportId=0,this._deviceWentOffline=!1,this._transportClosed=!0,this._codec=new ve,this._reconnecting=!1,this._reconnectTimeout=null,this._reconnectAttempts=0,this._client=null,this._session="",this._node="",this._subs={},this._serverSubs={},this._commandId=0,this._commands=[],this._batching=!1,this._refreshRequired=!1,this._refreshTimeout=null,this._callbacks={},this._token="",this._data=null,this._dispatchPromise=Promise.resolve(),this._serverPing=0,this._serverPingTimeout=null,this._sendPong=!1,this._promises={},this._promiseId=0,this._debugEnabled=!1,this._networkEventsSet=!1,this._config={...Di,...n},this._configure(),this._debugEnabled?(this.on("state",i=>{this._debug("client state",i.oldState,"->",i.newState)}),this.on("error",i=>{this._debug("client error",i)})):this.on("error",function(){Function.prototype()})}newSubscription(e,n){if(this.getSubscription(e)!==null)throw new Error("Subscription to the channel "+e+" already exists");let i=new Be(this,e,n);return this._subs[e]=i,i}getSubscription(e){return this._getSub(e)}removeSubscription(e){e&&(e.state!=="unsubscribed"&&e.unsubscribe(),this._removeSubscription(e))}subscriptions(){return this._subs}ready(e){return this.state==="disconnected"?Promise.reject({code:3,message:"client disconnected"}):this.state==="connected"?Promise.resolve():new Promise((n,i)=>{let s={resolve:n,reject:i};e&&(s.timeout=setTimeout(function(){i({code:1,message:"timeout"})},e)),this._promises[this._nextPromiseId()]=s})}connect(){if(this._isConnected()){this._debug("connect called when already connected");return}if(this._isConnecting()){this._debug("connect called when already connecting");return}this._debug("connect called"),this._reconnectAttempts=0,this._startConnecting()}disconnect(){this._disconnect(0,"disconnect called",!1)}setToken(e){this._token=e}send(e){let n={send:{data:e}},i=this;return this._methodCall().then(function(){return i._transportSendCommands([n])?Promise.resolve():Promise.reject(i._createErrorObject(10,"transport write error"))})}rpc(e,n){let i={rpc:{method:e,data:n}},s=this;return this._methodCall().then(function(){return s._callPromise(i,function(o){return{data:o.rpc.data}})})}publish(e,n){let i={publish:{channel:e,data:n}},s=this;return this._methodCall().then(function(){return s._callPromise(i,function(){return{}})})}history(e,n){let i={history:this._getHistoryRequest(e,n)},s=this;return this._methodCall().then(function(){return s._callPromise(i,function(o){let a=o.history,u=[];if(a.publications)for(let c=0;c<a.publications.length;c++)u.push(s._getPublicationContext(e,a.publications[c]));return{publications:u,epoch:a.epoch||"",offset:a.offset||0}})})}presence(e){let n={presence:{channel:e}},i=this;return this._methodCall().then(function(){return i._callPromise(n,function(s){let o=s.presence.presence;for(let a in o)if(o.hasOwnProperty(a)){let u=o[a].conn_info,c=o[a].chan_info;u&&(o[a].connInfo=u),c&&(o[a].chanInfo=c)}return{clients:o}})})}presenceStats(e){let n={presence_stats:{channel:e}},i=this;return this._methodCall().then(function(){return i._callPromise(n,function(s){let o=s.presence_stats;return{numUsers:o.num_users,numClients:o.num_clients}})})}startBatching(){this._batching=!0}stopBatching(){let e=this;Promise.resolve().then(function(){Promise.resolve().then(function(){e._batching=!1,e._flush()})})}_debug(...e){this._debugEnabled&&xn("debug",e)}_formatOverride(){}_configure(){if(!("Promise"in globalThis))throw new Error("Promise polyfill required");if(!this._endpoint)throw new Error("endpoint configuration required");if(this._config.token!==null&&(this._token=this._config.token),this._config.data!==null&&(this._data=this._config.data),this._codec=new ve,this._formatOverride(),(this._config.debug===!0||typeof localStorage<"u"&&localStorage.getItem("centrifuge.debug"))&&(this._debugEnabled=!0),this._debug("config",this._config),typeof this._endpoint!="string")if(typeof this._endpoint=="object"&&this._endpoint instanceof Array){this._transports=this._endpoint,this._emulation=!0;for(let e in this._transports)if(this._transports.hasOwnProperty(e)){let n=this._transports[e];if(!n.endpoint||!n.transport)throw new Error("malformed transport configuration");let i=n.transport;if(["websocket","http_stream","sse","sockjs","webtransport"].indexOf(i)<0)throw new Error("unsupported transport name: "+i)}}else throw new Error("unsupported url configuration type: only string or array of objects are supported")}_setState(e){if(this.state!==e){this._reconnecting=!1;let n=this.state;return this.state=e,this.emit("state",{newState:e,oldState:n}),!0}return!1}_isDisconnected(){return this.state==="disconnected"}_isConnecting(){return this.state==="connecting"}_isConnected(){return this.state==="connected"}_nextCommandId(){return++this._commandId}_setNetworkEvents(){if(this._networkEventsSet)return;let e=null;this._config.networkEventTarget!==null?e=this._config.networkEventTarget:typeof globalThis.addEventListener<"u"&&(e=globalThis),e&&(e.addEventListener("offline",()=>{this._debug("offline event triggered"),(this.state==="connected"||this.state==="connecting")&&(this._disconnect(1,"transport closed",!0),this._deviceWentOffline=!0)}),e.addEventListener("online",()=>{this._debug("online event triggered"),this.state==="connecting"&&(this._deviceWentOffline&&!this._transportClosed&&(this._deviceWentOffline=!1,this._transportClosed=!0),this._clearReconnectTimeout(),this._startReconnecting())}),this._networkEventsSet=!0)}_getReconnectDelay(){let e=le(this._reconnectAttempts,this._config.minReconnectDelay,this._config.maxReconnectDelay);return this._reconnectAttempts+=1,e}_clearOutgoingRequests(){for(let e in this._callbacks)if(this._callbacks.hasOwnProperty(e)){let n=this._callbacks[e];clearTimeout(n.timeout);let i=n.errback;if(!i)continue;i({error:this._createErrorObject(11,"connection closed")})}this._callbacks={}}_clearConnectedState(){this._client=null,this._clearServerPingTimeout(),this._clearRefreshTimeout();for(let e in this._subs){if(!this._subs.hasOwnProperty(e))continue;let n=this._subs[e];n.state==="subscribed"&&n._setSubscribing(1,"transport closed")}for(let e in this._serverSubs)this._serverSubs.hasOwnProperty(e)&&this.emit("subscribing",{channel:e})}_handleWriteError(e){for(let n of e){let i=n.id;if(!(i in this._callbacks))continue;let s=this._callbacks[i];clearTimeout(this._callbacks[i].timeout),delete this._callbacks[i];let o=s.errback;o({error:this._createErrorObject(10,"transport write error")})}}_transportSendCommands(e){if(!e.length)return!0;if(!this._transport)return!1;try{this._transport.send(this._codec.encodeCommands(e),this._session,this._node)}catch(n){return this._debug("error writing commands",n),this._handleWriteError(e),!1}return!0}_initializeTransport(){let e;this._config.websocket!==null?e=this._config.websocket:typeof globalThis.WebSocket!="function"&&typeof globalThis.WebSocket!="object"||(e=globalThis.WebSocket);let n=null;this._config.sockjs!==null?n=this._config.sockjs:typeof globalThis.SockJS<"u"&&(n=globalThis.SockJS);let i=null;this._config.eventsource!==null?i=this._config.eventsource:typeof globalThis.EventSource<"u"&&(i=globalThis.EventSource);let s=null;this._config.fetch!==null?s=this._config.fetch:typeof globalThis.fetch<"u"&&(s=globalThis.fetch);let o=null;if(this._config.readableStream!==null?o=this._config.readableStream:typeof globalThis.ReadableStream<"u"&&(o=globalThis.ReadableStream),this._emulation){this._currentTransportIndex>=this._transports.length&&(this._triedAllTransports=!0,this._currentTransportIndex=0);let h=0;for(;;){if(h>=this._transports.length)throw new Error("no supported transport found");let y=this._transports[this._currentTransportIndex],v=y.transport,w=y.endpoint;if(v==="websocket"){if(this._debug("trying websocket transport"),this._transport=new be(w,{websocket:e}),!this._transport.supported()){this._debug("websocket transport not available"),this._currentTransportIndex++,h++;continue}}else if(v==="webtransport"){if(this._debug("trying webtransport transport"),this._transport=new Me(w,{webtransport:globalThis.WebTransport,decoder:this._codec,encoder:this._codec}),!this._transport.supported()){this._debug("webtransport transport not available"),this._currentTransportIndex++,h++;continue}}else if(v==="http_stream"){if(this._debug("trying http_stream transport"),this._transport=new Fe(w,{fetch:s,readableStream:o,emulationEndpoint:this._config.emulationEndpoint,decoder:this._codec,encoder:this._codec}),!this._transport.supported()){this._debug("http_stream transport not available"),this._currentTransportIndex++,h++;continue}}else if(v==="sse"){if(this._debug("trying sse transport"),this._transport=new Je(w,{eventsource:i,fetch:s,emulationEndpoint:this._config.emulationEndpoint}),!this._transport.supported()){this._debug("sse transport not available"),this._currentTransportIndex++,h++;continue}}else if(v==="sockjs"){if(this._debug("trying sockjs"),this._transport=new je(w,{sockjs:n,sockjsOptions:this._config.sockjsOptions}),!this._transport.supported()){this._debug("sockjs transport not available"),this._currentTransportIndex++,h++;continue}}else throw new Error("unknown transport "+v);break}}else{if(Sn(this._endpoint,"http"))throw new Error("Provide explicit transport endpoints configuration in case of using HTTP (i.e. using array of TransportEndpoint instead of a single string), or use ws(s):// scheme in an endpoint if you aimed using WebSocket transport");if(this._debug("client will use websocket"),this._transport=new be(this._endpoint,{websocket:e}),!this._transport.supported())throw new Error("WebSocket not available")}let a=this,u=this._transport,c=this._nextTransportId();a._debug("id of transport",c);let l=!1,b=[];if(this._transport.emulation()){let h=a._sendConnect(!0);b.push(h)}this._setNetworkEvents();let x=this._codec.encodeCommands(b);this._transportClosed=!1;let p;p=setTimeout(function(){u.close()},this._config.timeout),this._transport.initialize(this._codec.name(),{onOpen:function(){if(p&&(clearTimeout(p),p=null),a._transportId!=c){a._debug("open callback from non-actual transport"),u.close();return}l=!0,a._debug(u.subName(),"transport open"),!u.emulation()&&(a._transportIsOpen=!0,a._transportWasOpen=!0,a.startBatching(),a._sendConnect(!1),a._sendSubscribeCommands(),a.stopBatching(),a.emit("__centrifuge_debug:connect_frame_sent",{}))},onError:function(h){if(a._transportId!=c){a._debug("error callback from non-actual transport");return}a._debug("transport level error",h)},onClose:function(h){if(p&&(clearTimeout(p),p=null),a._transportId!=c){a._debug("close callback from non-actual transport");return}a._debug(u.subName(),"transport closed"),a._transportClosed=!0,a._transportIsOpen=!1;let y="connection closed",v=!0,w=0;if(h&&"code"in h&&h.code&&(w=h.code),h&&h.reason)try{let ge=JSON.parse(h.reason);y=ge.reason,v=ge.reconnect}catch{y=h.reason,(w>=3500&&w<4e3||w>=4500&&w<5e3)&&(v=!1)}w<3e3?(w===1009?(w=3,y="message size limit exceeded",v=!1):(w=1,y="transport closed"),a._emulation&&!a._transportWasOpen&&(a._currentTransportIndex++,a._currentTransportIndex>=a._transports.length&&(a._triedAllTransports=!0,a._currentTransportIndex=0))):a._transportWasOpen=!0,a._isConnecting()&&!l&&a.emit("error",{type:"transport",error:{code:2,message:"transport closed"},transport:u.name()}),a._reconnecting=!1,a._disconnect(w,y,v)},onMessage:function(h){a._dataReceived(h)}},x),a.emit("__centrifuge_debug:transport_initialized",{})}_sendConnect(e){let n=this._constructConnectCommand(),i=this;return this._call(n,e).then(s=>{let o=s.reply.connect;i._connectResponse(o),s.next&&s.next()},s=>{i._connectError(s.error),s.next&&s.next()}),n}_startReconnecting(){if(this._debug("start reconnecting"),!this._isConnecting()){this._debug("stop reconnecting: client not in connecting state");return}if(this._reconnecting){this._debug("reconnect already in progress, return from reconnect routine");return}if(this._transportClosed===!1){this._debug("waiting for transport close");return}this._reconnecting=!0;let e=this,n=this._token==="";if(!(this._refreshRequired||n&&this._config.getToken!==null)){this._config.getData?this._config.getData().then(function(s){e._isConnecting()&&(e._data=s,e._initializeTransport())}):this._initializeTransport();return}this._getToken().then(function(s){if(e._isConnecting()){if(s==null||s==null){e._failUnauthorized();return}e._token=s,e._debug("connection token refreshed"),e._config.getData?e._config.getData().then(function(o){e._isConnecting()&&(e._data=o,e._initializeTransport())}):e._initializeTransport()}}).catch(function(s){if(!e._isConnecting())return;if(s instanceof z){e._failUnauthorized();return}e.emit("error",{type:"connectToken",error:{code:5,message:s!==void 0?s.toString():""}});let o=e._getReconnectDelay();e._debug("error on connection token refresh, reconnect after "+o+" milliseconds",s),e._reconnecting=!1,e._reconnectTimeout=setTimeout(()=>{e._startReconnecting()},o)})}_connectError(e){this.state==="connecting"&&(e.code===109&&(this._refreshRequired=!0),e.code<100||e.temporary===!0||e.code===109?(this.emit("error",{type:"connect",error:e}),this._debug("closing transport due to connect error"),this._disconnect(e.code,e.message,!0)):this._disconnect(e.code,e.message,!1))}_scheduleReconnect(){if(!this._isConnecting())return;let e=!1;this._emulation&&!this._transportWasOpen&&!this._triedAllTransports&&(e=!0);let n=this._getReconnectDelay();e&&(n=0),this._debug("reconnect after "+n+" milliseconds"),this._clearReconnectTimeout(),this._reconnectTimeout=setTimeout(()=>{this._startReconnecting()},n)}_constructConnectCommand(){let e={};this._token&&(e.token=this._token),this._data&&(e.data=this._data),this._config.name&&(e.name=this._config.name),this._config.version&&(e.version=this._config.version);let n={},i=!1;for(let s in this._serverSubs)if(this._serverSubs.hasOwnProperty(s)&&this._serverSubs[s].recoverable){i=!0;let o={recover:!0};this._serverSubs[s].offset&&(o.offset=this._serverSubs[s].offset),this._serverSubs[s].epoch&&(o.epoch=this._serverSubs[s].epoch),n[s]=o}return i&&(e.subs=n),{connect:e}}_getHistoryRequest(e,n){let i={channel:e};return n!==void 0&&(n.since&&(i.since={offset:n.since.offset},n.since.epoch&&(i.since.epoch=n.since.epoch)),n.limit!==void 0&&(i.limit=n.limit),n.reverse===!0&&(i.reverse=!0)),i}_methodCall(){return this._isConnected()?Promise.resolve():new Promise((e,n)=>{let i=setTimeout(function(){n({code:1,message:"timeout"})},this._config.timeout);this._promises[this._nextPromiseId()]={timeout:i,resolve:e,reject:n}})}_callPromise(e,n){return new Promise((i,s)=>{this._call(e,!1).then(o=>{i(n(o.reply)),o.next&&o.next()},o=>{s(o.error),o.next&&o.next()})})}_dataReceived(e){this._serverPing>0&&this._waitServerPing();let n=this._codec.decodeReplies(e);this._dispatchPromise=this._dispatchPromise.then(()=>{let i;this._dispatchPromise=new Promise(s=>{i=s}),this._dispatchSynchronized(n,i)})}_dispatchSynchronized(e,n){let i=Promise.resolve();for(let s in e)e.hasOwnProperty(s)&&(i=i.then(()=>this._dispatchReply(e[s])));i=i.then(()=>{n()})}_dispatchReply(e){let n,i=new Promise(o=>{n=o});if(e==null)return this._debug("dispatch: got undefined or null reply"),n(),i;let s=e.id;return s&&s>0?this._handleReply(e,n):e.push?this._handlePush(e.push,n):this._handleServerPing(n),i}_call(e,n){return new Promise((i,s)=>{e.id=this._nextCommandId(),this._registerCall(e.id,i,s),n||this._addCommand(e)})}_startConnecting(){this._debug("start connecting"),this._setState("connecting")&&this.emit("connecting",{code:0,reason:"connect called"}),this._client=null,this._startReconnecting()}_disconnect(e,n,i){if(this._isDisconnected())return;this._transportIsOpen=!1;let s=this.state;this._reconnecting=!1;let o={code:e,reason:n},a=!1;if(i?a=this._setState("connecting"):(a=this._setState("disconnected"),this._rejectPromises({code:3,message:"disconnected"})),this._clearOutgoingRequests(),s==="connecting"&&this._clearReconnectTimeout(),s==="connected"&&this._clearConnectedState(),a&&(this._isConnecting()?this.emit("connecting",o):this.emit("disconnected",o)),this._transport){this._debug("closing existing transport");let u=this._transport;this._transport=null,u.close(),this._transportClosed=!0,this._nextTransportId()}else this._debug("no transport to close");this._scheduleReconnect()}_failUnauthorized(){this._disconnect(1,"unauthorized",!1)}_getToken(){if(this._debug("get connection token"),!this._config.getToken)throw this.emit("error",{type:"configuration",error:{code:12,message:"token expired but no getToken function set in the configuration"}}),new z("");return this._config.getToken({})}_refresh(){let e=this._client,n=this;this._getToken().then(function(i){if(e!==n._client)return;if(!i){n._failUnauthorized();return}if(n._token=i,n._debug("connection token refreshed"),!n._isConnected())return;let s={refresh:{token:n._token}};n._call(s,!1).then(o=>{let a=o.reply.refresh;n._refreshResponse(a),o.next&&o.next()},o=>{n._refreshError(o.error),o.next&&o.next()})}).catch(function(i){if(n._isConnected()){if(i instanceof z){n._failUnauthorized();return}n.emit("error",{type:"refreshToken",error:{code:6,message:i!==void 0?i.toString():""}}),n._refreshTimeout=setTimeout(()=>n._refresh(),n._getRefreshRetryDelay())}})}_refreshError(e){e.code<100||e.temporary===!0?(this.emit("error",{type:"refresh",error:e}),this._refreshTimeout=setTimeout(()=>this._refresh(),this._getRefreshRetryDelay())):this._disconnect(e.code,e.message,!1)}_getRefreshRetryDelay(){return le(0,5e3,1e4)}_refreshResponse(e){this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null),e.expires&&(this._client=e.client,this._refreshTimeout=setTimeout(()=>this._refresh(),fe(e.ttl)))}_removeSubscription(e){e!==null&&delete this._subs[e.channel]}_unsubscribe(e){if(!this._transportIsOpen)return;let i={unsubscribe:{channel:e.channel}},s=this;this._call(i,!1).then(o=>{o.next&&o.next()},o=>{o.next&&o.next(),s._disconnect(4,"unsubscribe error",!0)})}_getSub(e){let n=this._subs[e];return n||null}_isServerSub(e){return this._serverSubs[e]!==void 0}_sendSubscribeCommands(){let e=[];for(let n in this._subs){if(!this._subs.hasOwnProperty(n))continue;let i=this._subs[n];if(i._inflight!==!0&&i.state==="subscribing"){let s=i._subscribe();s&&e.push(s)}}return e}_connectResponse(e){if(this._transportIsOpen=!0,this._transportWasOpen=!0,this._reconnectAttempts=0,this._refreshRequired=!1,this._isConnected())return;this._client=e.client,this._setState("connected"),this._refreshTimeout&&clearTimeout(this._refreshTimeout),e.expires&&(this._refreshTimeout=setTimeout(()=>this._refresh(),fe(e.ttl))),this._session=e.session,this._node=e.node,this.startBatching(),this._sendSubscribeCommands(),this.stopBatching();let n={client:e.client,transport:this._transport.subName()};e.data&&(n.data=e.data),this.emit("connected",n),this._resolvePromises(),this._processServerSubs(e.subs||{}),e.ping&&e.ping>0?(this._serverPing=e.ping*1e3,this._sendPong=e.pong===!0,this._waitServerPing()):this._serverPing=0}_processServerSubs(e){for(let n in e){if(!e.hasOwnProperty(n))continue;let i=e[n];this._serverSubs[n]={offset:i.offset,epoch:i.epoch,recoverable:i.recoverable||!1};let s=this._getSubscribeContext(n,i);this.emit("subscribed",s)}for(let n in e){if(!e.hasOwnProperty(n))continue;let i=e[n];if(i.recovered){let s=i.publications;if(s&&s.length>0)for(let o in s)s.hasOwnProperty(o)&&this._handlePublication(n,s[o])}}for(let n in this._serverSubs)this._serverSubs.hasOwnProperty(n)&&(e[n]||(this.emit("unsubscribed",{channel:n}),delete this._serverSubs[n]))}_clearRefreshTimeout(){this._refreshTimeout!==null&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null)}_clearReconnectTimeout(){this._reconnectTimeout!==null&&(clearTimeout(this._reconnectTimeout),this._reconnectTimeout=null)}_clearServerPingTimeout(){this._serverPingTimeout!==null&&(clearTimeout(this._serverPingTimeout),this._serverPingTimeout=null)}_waitServerPing(){this._config.maxServerPingDelay!==0&&this._isConnected()&&(this._clearServerPingTimeout(),this._serverPingTimeout=setTimeout(()=>{this._isConnected()&&this._disconnect(2,"no ping",!0)},this._serverPing+this._config.maxServerPingDelay))}_getSubscribeContext(e,n){let i={channel:e,positioned:!1,recoverable:!1,wasRecovering:!1,recovered:!1};n.recovered&&(i.recovered=!0),n.positioned&&(i.positioned=!0),n.recoverable&&(i.recoverable=!0),n.was_recovering&&(i.wasRecovering=!0);let s="";"epoch"in n&&(s=n.epoch);let o=0;return"offset"in n&&(o=n.offset),(i.positioned||i.recoverable)&&(i.streamPosition={offset:o,epoch:s}),n.data&&(i.data=n.data),i}_handleReply(e,n){let i=e.id;if(!(i in this._callbacks)){n();return}let s=this._callbacks[i];if(clearTimeout(this._callbacks[i].timeout),delete this._callbacks[i],On(e)){let o=s.errback;if(!o){n();return}let a=e.error;o({error:a,next:n})}else{let o=s.callback;if(!o)return;o({reply:e,next:n})}}_handleJoin(e,n){let i=this._getSub(e);if(!i){if(this._isServerSub(e)){let s={channel:e,info:this._getJoinLeaveContext(n.info)};this.emit("join",s)}return}i._handleJoin(n)}_handleLeave(e,n){let i=this._getSub(e);if(!i){if(this._isServerSub(e)){let s={channel:e,info:this._getJoinLeaveContext(n.info)};this.emit("leave",s)}return}i._handleLeave(n)}_handleUnsubscribe(e,n){let i=this._getSub(e);if(!i){this._isServerSub(e)&&(delete this._serverSubs[e],this.emit("unsubscribed",{channel:e}));return}n.code<2500?i._setUnsubscribed(n.code,n.reason,!1):i._setSubscribing(n.code,n.reason)}_handleSubscribe(e,n){this._serverSubs[e]={offset:n.offset,epoch:n.epoch,recoverable:n.recoverable||!1},this.emit("subscribed",this._getSubscribeContext(e,n))}_handleDisconnect(e){let n=e.code,i=!0;(n>=3500&&n<4e3||n>=4500&&n<5e3)&&(i=!1),this._disconnect(n,e.reason,i)}_getPublicationContext(e,n){let i={channel:e,data:n.data};return n.offset&&(i.offset=n.offset),n.info&&(i.info=this._getJoinLeaveContext(n.info)),n.tags&&(i.tags=n.tags),i}_getJoinLeaveContext(e){let n={client:e.client,user:e.user};return e.conn_info&&(n.connInfo=e.conn_info),e.chan_info&&(n.chanInfo=e.chan_info),n}_handlePublication(e,n){let i=this._getSub(e);if(!i){if(this._isServerSub(e)){let s=this._getPublicationContext(e,n);this.emit("publication",s),n.offset!==void 0&&(this._serverSubs[e].offset=n.offset)}return}i._handlePublication(n)}_handleMessage(e){this.emit("message",{data:e.data})}_handleServerPing(e){if(this._sendPong){let n={};this._transportSendCommands([n])}e()}_handlePush(e,n){let i=e.channel;e.pub?this._handlePublication(i,e.pub):e.message?this._handleMessage(e.message):e.join?this._handleJoin(i,e.join):e.leave?this._handleLeave(i,e.leave):e.unsubscribe?this._handleUnsubscribe(i,e.unsubscribe):e.subscribe?this._handleSubscribe(i,e.subscribe):e.disconnect&&this._handleDisconnect(e.disconnect),n()}_flush(){let e=this._commands.slice(0);this._commands=[],this._transportSendCommands(e)}_createErrorObject(e,n,i){let s={code:e,message:n};return i&&(s.temporary=!0),s}_registerCall(e,n,i){this._callbacks[e]={callback:n,errback:i,timeout:null},this._callbacks[e].timeout=setTimeout(()=>{delete this._callbacks[e],dt(i)&&i({error:this._createErrorObject(1,"timeout")})},this._config.timeout)}_addCommand(e){this._batching?this._commands.push(e):this._transportSendCommands([e])}_nextPromiseId(){return++this._promiseId}_nextTransportId(){return++this._transportId}_resolvePromises(){for(let e in this._promises)this._promises.hasOwnProperty(e)&&(this._promises[e].timeout&&clearTimeout(this._promises[e].timeout),this._promises[e].resolve(),delete this._promises[e])}_rejectPromises(e){for(let n in this._promises)this._promises.hasOwnProperty(n)&&(this._promises[n].timeout&&clearTimeout(this._promises[n].timeout),this._promises[n].reject(e),delete this._promises[n])}};re.SubscriptionState=Ie;re.State=Le;re.UnauthorizedError=z;var ne=lt(fi());var ln={};bi(ln,{default:()=>Os,nested:()=>xs});var xs={centrifugal:{nested:{centrifuge:{nested:{protocol:{options:{go_package:"./;protocol"},nested:{Error:{fields:{code:{type:"uint32",id:1},message:{type:"string",id:2},temporary:{type:"bool",id:3}}},EmulationRequest:{fields:{node:{type:"string",id:1},session:{type:"string",id:2},data:{type:"bytes",id:3}}},Command:{fields:{id:{type:"uint32",id:1},connect:{type:"ConnectRequest",id:4},subscribe:{type:"SubscribeRequest",id:5},unsubscribe:{type:"UnsubscribeRequest",id:6},publish:{type:"PublishRequest",id:7},presence:{type:"PresenceRequest",id:8},presence_stats:{type:"PresenceStatsRequest",id:9},history:{type:"HistoryRequest",id:10},ping:{type:"PingRequest",id:11},send:{type:"SendRequest",id:12},rpc:{type:"RPCRequest",id:13},refresh:{type:"RefreshRequest",id:14},sub_refresh:{type:"SubRefreshRequest",id:15}},reserved:[[2,2],[3,3]]},Reply:{fields:{id:{type:"uint32",id:1},error:{type:"Error",id:2},push:{type:"Push",id:4},connect:{type:"ConnectResult",id:5},subscribe:{type:"SubscribeResult",id:6},unsubscribe:{type:"UnsubscribeResult",id:7},publish:{type:"PublishResult",id:8},presence:{type:"PresenceResult",id:9},presence_stats:{type:"PresenceStatsResult",id:10},history:{type:"HistoryResult",id:11},ping:{type:"PingResult",id:12},rpc:{type:"RPCResult",id:13},refresh:{type:"RefreshResult",id:14},sub_refresh:{type:"SubRefreshResult",id:15}},reserved:[[3,3]]},Push:{fields:{channel:{type:"string",id:2},pub:{type:"Publication",id:4},join:{type:"Join",id:5},leave:{type:"Leave",id:6},unsubscribe:{type:"Unsubscribe",id:7},message:{type:"Message",id:8},subscribe:{type:"Subscribe",id:9},connect:{type:"Connect",id:10},disconnect:{type:"Disconnect",id:11},refresh:{type:"Refresh",id:12}},reserved:[[1,1],[3,3]]},ClientInfo:{fields:{user:{type:"string",id:1},client:{type:"string",id:2},conn_info:{type:"bytes",id:3},chan_info:{type:"bytes",id:4}}},Publication:{fields:{data:{type:"bytes",id:4},info:{type:"ClientInfo",id:5},offset:{type:"uint64",id:6},tags:{keyType:"string",type:"string",id:7},delta:{type:"bool",id:8},time:{type:"int64",id:9}},reserved:[[1,1],[2,2],[3,3]]},Join:{fields:{info:{type:"ClientInfo",id:1}}},Leave:{fields:{info:{type:"ClientInfo",id:1}}},Unsubscribe:{fields:{code:{type:"uint32",id:2},reason:{type:"string",id:3}},reserved:[[1,1]]},Subscribe:{fields:{recoverable:{type:"bool",id:1},epoch:{type:"string",id:4},offset:{type:"uint64",id:5},positioned:{type:"bool",id:6},data:{type:"bytes",id:7}},reserved:[[2,2],[3,3]]},Message:{fields:{data:{type:"bytes",id:1}}},Connect:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},data:{type:"bytes",id:3},subs:{keyType:"string",type:"SubscribeResult",id:4},expires:{type:"bool",id:5},ttl:{type:"uint32",id:6},ping:{type:"uint32",id:7},pong:{type:"bool",id:8},session:{type:"string",id:9},node:{type:"string",id:10},time:{type:"int64",id:11}}},Disconnect:{fields:{code:{type:"uint32",id:1},reason:{type:"string",id:2},reconnect:{type:"bool",id:3}}},Refresh:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2}}},ConnectRequest:{fields:{token:{type:"string",id:1},data:{type:"bytes",id:2},subs:{keyType:"string",type:"SubscribeRequest",id:3},name:{type:"string",id:4},version:{type:"string",id:5}}},ConnectResult:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},expires:{type:"bool",id:3},ttl:{type:"uint32",id:4},data:{type:"bytes",id:5},subs:{keyType:"string",type:"SubscribeResult",id:6},ping:{type:"uint32",id:7},pong:{type:"bool",id:8},session:{type:"string",id:9},node:{type:"string",id:10},time:{type:"int64",id:11}}},RefreshRequest:{fields:{token:{type:"string",id:1}}},RefreshResult:{fields:{client:{type:"string",id:1},version:{type:"string",id:2},expires:{type:"bool",id:3},ttl:{type:"uint32",id:4}}},SubscribeRequest:{fields:{channel:{type:"string",id:1},token:{type:"string",id:2},recover:{type:"bool",id:3},epoch:{type:"string",id:6},offset:{type:"uint64",id:7},data:{type:"bytes",id:8},positioned:{type:"bool",id:9},recoverable:{type:"bool",id:10},join_leave:{type:"bool",id:11},delta:{type:"string",id:12}},reserved:[[4,4],[5,5]]},SubscribeResult:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2},recoverable:{type:"bool",id:3},epoch:{type:"string",id:6},publications:{rule:"repeated",type:"Publication",id:7},recovered:{type:"bool",id:8},offset:{type:"uint64",id:9},positioned:{type:"bool",id:10},data:{type:"bytes",id:11},was_recovering:{type:"bool",id:12},delta:{type:"bool",id:13}},reserved:[[4,4],[5,5]]},SubRefreshRequest:{fields:{channel:{type:"string",id:1},token:{type:"string",id:2}}},SubRefreshResult:{fields:{expires:{type:"bool",id:1},ttl:{type:"uint32",id:2}}},UnsubscribeRequest:{fields:{channel:{type:"string",id:1}}},UnsubscribeResult:{fields:{}},PublishRequest:{fields:{channel:{type:"string",id:1},data:{type:"bytes",id:2}}},PublishResult:{fields:{}},PresenceRequest:{fields:{channel:{type:"string",id:1}}},PresenceResult:{fields:{presence:{keyType:"string",type:"ClientInfo",id:1}}},PresenceStatsRequest:{fields:{channel:{type:"string",id:1}}},PresenceStatsResult:{fields:{num_clients:{type:"uint32",id:1},num_users:{type:"uint32",id:2}}},StreamPosition:{fields:{offset:{type:"uint64",id:1},epoch:{type:"string",id:2}}},HistoryRequest:{fields:{channel:{type:"string",id:1},limit:{type:"int32",id:7},since:{type:"StreamPosition",id:8},reverse:{type:"bool",id:9}},reserved:[[2,2],[3,3],[4,4],[5,5],[6,6]]},HistoryResult:{fields:{publications:{rule:"repeated",type:"Publication",id:1},epoch:{type:"string",id:2},offset:{type:"uint64",id:3}}},PingRequest:{fields:{}},PingResult:{fields:{}},RPCRequest:{fields:{data:{type:"bytes",id:1},method:{type:"string",id:2}}},RPCResult:{fields:{data:{type:"bytes",id:1}}},SendRequest:{fields:{data:{type:"bytes",id:1}}}}}}}}}},Os={nested:xs};var fn=ne.Root.fromJSON(ln),Es=fn.lookupType("protocol.Command"),di=fn.lookupType("protocol.Reply"),Ts=fn.lookupType("protocol.EmulationRequest"),at=class{name(){return"protobuf"}encodeEmulationRequest(t){let e=ne.Writer.create();return Ts.encode(t,e),e.finish()}encodeCommands(t){let e=ne.Writer.create();for(let n in t)if(t.hasOwnProperty(n)){let i=Object.assign({},t[n]);Es.encodeDelimited(i,e)}return e.finish()}decodeReplies(t){let e=[],n=ne.Reader.create(new Uint8Array(t));for(;n.pos<n.len;){let i=di.decodeDelimited(n);e.push(i)}return e}decodeReply(t){let e=ne.Reader.create(new Uint8Array(t));for(;e.pos<e.len;)return di.decodeDelimited(e),{ok:!0,pos:e.pos};return{ok:!1}}applyDeltaIfNeeded(t,e){let n,i;if(t.delta){let s=Ue(e,t.data);n=new Uint8Array(s),i=s}else n=t.data,i=t.data;return{newData:n,newPrevValue:i}}};var ut=class extends re{_formatOverride(){this._codec=new at}};globalThis.Centrifuge=ut;})();
//# sourceMappingURL=centrifuge.protobuf.js.map
